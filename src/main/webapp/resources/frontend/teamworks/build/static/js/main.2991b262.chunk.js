(this.webpackJsonpteamworks=this.webpackJsonpteamworks||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){},117:function(e,t,n){},123:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n(1),r=n.n(a),c=n(26),o=n.n(c),i=(n(64),n(2)),l=n(7),d=n(8),u=(n(65),n(6)),j=n(3),b=n(11),m=n(12),h=n(14),O=n(13),g=n(23),p=n.n(g),f="/api",x={get:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(n,s){p.a.get(f+e).then((function(e){return n(e.data)})).catch((function(e){var n;403===(null===(n=e.response)||void 0===n?void 0:n.status)&&t&&window.location.replace("/"),s(e)}))}))},post:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise((function(s,a){p.a.post(f+e,t).then((function(e){return s(e.data)})).catch((function(e){var t;403===(null===(t=e.response)||void 0===t?void 0:t.status)&&n&&window.location.replace("/"),a(e)}))}))},patch:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise((function(s,a){p.a.patch(f+e,t).then((function(e){return s(e.data)})).catch((function(e){var t;403===(null===(t=e.response)||void 0===t?void 0:t.status)&&n&&window.location.replace("/"),a(e)}))}))},delete:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(n,s){p.a.delete(f+e).then((function(e){return n(e.data)})).catch((function(e){var n;403===(null===(n=e.response)||void 0===n?void 0:n.status)&&t&&window.location.replace("/"),s(e)}))}))}},M="/auth",v={login:function(e){return x.post("/auth/login",e,!1)},islogged:function(){return x.get("/auth/islogged",!1)},signup:function(e){return x.post("/auth/signup",e,!1)},check:function(){return x.get(M,!1)},logout:function(){return x.delete("/auth/logout",!1)}};n(25);function N(e){var t=e.error;return Object(s.jsxs)("p",{className:"Error",children:[" ",t]})}function T(e){var t=e.name,n=e.type,a=e.placeholder,r=e.styleClass,c=e.value,o=e.error,i=e.changeHandler;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("input",{placeholder:a,className:r,id:t,type:n,name:t,value:c,onChange:function(e){return i(t,e.target.value,n)},style:{border:o&&""!==o?"1px solid #e32d2d":""}}),Object(s.jsx)(N,{error:o})]})}function y(e){var t=e.error;return Object(s.jsxs)("p",{className:"SubmitError",children:[" ",t]})}n(83);var I=function(e){var t=e.children,n=e.disabled,a=e.onClick,r=e.className;e.type;return Object(s.jsxs)("button",{className:"GradientButton ".concat(r),onClick:a,action:"none",disabled:n,children:[t," "]})},S=(n(84),function(e){var t=e.dark,n=e.red,a=e.green,r=e.className;return Object(s.jsx)("div",{className:"Spinner ".concat(t?"Spinner--Dark":""," ").concat(n?"Spinner--Red":""," ").concat(a?"Spinner--Green":""," ").concat(r)})});function w(e){var t=e.text,n=e.requestError,a=e.hasErrors,r=e.reducedsize,c=e.loading?Object(s.jsx)(S,{dark:!0}):t;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("br",{}),Object(s.jsx)(I,{className:r?"":"SubmitButton",type:"submit",disabled:a,children:c}),Object(s.jsx)(y,{error:""!==n&&n})]})}var D=function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors),t=Object.keys(s.state.inputs).length;return e.length<t||e.some((function(e){return""!==e}))},s.validateAll=function(){Object.entries(s.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];s.validate(n,a)}))},s.validate=function(e,t){s.setState({requestError:""}),s.setState();var n="";switch(e){case"mail":""===t?n="Mail required":/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@+[a-zA-Z0-9-]/.test(t)||(n="Invalid Mail");break;case"password":""===t?n="Password required":t.length<8&&(n="Passwords are larger")}s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},Object(u.a)({},e,n))})},s.changeHandler=function(e,t){s.validate(e,t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},Object(u.a)({},e,t))})},s.apiRequestHandler=function(e,t){v.login({mail:e,password:t}).then((function(e){s.props.onLoginChanged(!0)})).catch((function(e){console.log("API ERROR!"),console.log(e),s.setState({requestError:"User not Found"})}))},s.submitHandler=function(e){if(e.preventDefault(),s.validateAll(),!s.hasErrors()){var t=s.state.inputs.mail,n=s.state.inputs.password;s.apiRequestHandler(t,n)}},s.state={inputs:{mail:"",password:""},errors:{},requestError:""},s}return Object(m.a)(n,[{key:"render",value:function(){return Object(s.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(s.jsx)("br",{}),Object(s.jsx)(T,{name:"mail",type:"text",placeholder:"name@team",styleClass:"Input InputLogin",error:this.state.errors.mail,changeHandler:this.changeHandler}),Object(s.jsx)("br",{}),Object(s.jsx)(T,{name:"password",type:"password",placeholder:"Password",styleClass:"Input InputLogin",error:this.state.errors.password,changeHandler:this.changeHandler}),Object(s.jsx)("br",{}),Object(s.jsx)(w,{text:"Log in",requestError:this.state.requestError,hasErrors:this.hasErrors()})]})}}]),n}(r.a.Component),C=function(e){var t=e.onLoginChanged;return Object(s.jsx)("div",{className:"Container",children:Object(s.jsxs)("div",{className:"LoginBox",children:[Object(s.jsxs)("div",{className:"Title",children:[Object(s.jsx)("span",{className:"TeamWord",children:"TEAM"}),Object(s.jsx)("span",{className:"WorksWord",children:"WORKS"})]}),Object(s.jsx)(D,{onLoginChanged:t}),Object(s.jsx)(l.b,{to:"/signup",className:"NewTeam",children:"Create your own team"})]})})},L=(n(89),function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors),t=Object.keys(s.state.inputs).length;return e.length<t||e.some((function(e){return""!==e}))},s.validateAll=function(){Object.entries(s.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];s.validate(n,a)}))},s.validate=function(e,t){s.setState({requestError:""});var n="";switch(e){case"teamname":""===t?n="TeamName required":/^[A-Za-z\xc0-\xff0-9\u00f1\u00d1_-]*$/.test(t)?t.length>25&&(n="The name is too long"):n="Invalid, use letters and numbers";break;case"identifier":""===t?n="Identifier required":/^[A-Za-z\xc0-\xff\u00f1\u00d1_-]*$/.test(t)?t.length>25&&(n="The identifier is too long"):n="Invalid, use letters and numbers";break;case"username":""===t?n="Username required":/^[A-Za-z\xc0-\xff\u00f1\u00d1]*$/.test(t)?t.length>25&&(n="The name is too long"):n="Invalid, use letters and numbers";break;case"lastname":""===t?n="Lastname required":/^[A-Za-z\xc0-\xff\u00f1\u00d1]*$/.test(t)?t.length>120&&(n="The name is too long"):n="Invalid, use letters and numbers";break;case"password":""===t?n="Password required":t.length<8?n="Passwords must be larger":t.length>25&&(n="The password is too long")}s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},Object(u.a)({},e,n))})},s.changeHandler=function(e,t){s.validate(e,t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},Object(u.a)({},e,t))})},s.apiRequestHandler=function(e,t,n,a,r){v.signup({teamname:e,identifier:t,username:n,lastname:a,password:r}).then((function(e){console.log("Signed Up, redirecting to login");var s="".concat(n.toLowerCase()).concat(a.toLowerCase(),"@").concat(t);v.login({mail:s,password:r}).then((function(){window.location.replace("/")}))})).catch((function(e){e.response.data.includes("constraint")?s.setState({requestError:"There's already a team or identifier with that name."}):(console.log("API ERROR!"),console.log(e),s.setState({requestError:"We had a server problem"}))}))},s.submitHandler=function(e){if(e.preventDefault(),s.validateAll(),s.hasErrors())console.log("There are errors in this form"),console.log(s.state.errors);else{var t=s.state.inputs.teamname,n=s.state.inputs.identifier,a=s.state.inputs.username,r=s.state.inputs.lastname,c=s.state.inputs.password;s.apiRequestHandler(t,n,a,r,c)}},s.state={inputs:{teamname:"",identifier:"",username:"",lastname:"",password:""},errors:{},requestError:""},s}return Object(m.a)(n,[{key:"render",value:function(){return Object(s.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(s.jsx)("p",{className:"InputTitle",children:"Team name"}),Object(s.jsx)(T,{name:"teamname",type:"text",placeholder:"Stark Industries",styleClass:"Input InputLogin",error:this.state.errors.teamname,changeHandler:this.changeHandler}),Object(s.jsx)("p",{className:"InputTitle",children:"Shorthand Identifier"}),Object(s.jsx)(T,{name:"identifier",type:"text",placeholder:"stark",styleClass:"Input InputLogin",error:this.state.errors.identifier,changeHandler:this.changeHandler}),Object(s.jsx)("br",{}),Object(s.jsx)("span",{className:"PreviewWord",children:"PREVIEW"})," ",Object(s.jsxs)("span",{className:"Preview",children:[this.state.inputs.username.toLowerCase(),this.state.inputs.lastname,"@",this.state.inputs.identifier]}),Object(s.jsx)("svg",{className:"Line",children:Object(s.jsx)("line",{x1:"0",y1:"0",x2:"1000",y2:"0",className:"ColorLine"})}),Object(s.jsx)("p",{className:"InputTitle",children:"Name"}),Object(s.jsx)(T,{name:"username",type:"text",placeholder:"Johnny",styleClass:"Input InputLogin",error:this.state.errors.username,changeHandler:this.changeHandler}),Object(s.jsx)("p",{className:"InputTitle",children:"LastName"}),Object(s.jsx)(T,{name:"lastname",type:"text",placeholder:"Deep",styleClass:"Input InputLogin",error:this.state.errors.lastname,changeHandler:this.changeHandler}),Object(s.jsx)("p",{className:"InputTitle",children:"Password"}),Object(s.jsx)(T,{name:"password",type:"password",placeholder:"Password",styleClass:"Input InputLogin",error:this.state.errors.password,changeHandler:this.changeHandler}),Object(s.jsx)(w,{text:"Sign up",requestError:this.state.requestError,hasErrors:this.hasErrors()})]})}}]),n}(r.a.Component)),E=n(9),A=n(10),k=(n(92),n(93),function(e){var t=e.children,n=e.className,a=e.onClick;return Object(s.jsx)("button",{className:"Button ".concat(n),onClick:a,action:"none",children:t})}),P=Object(d.h)((function(e){var t=e.history,n=e.path,a=e.children,r=e.className,c=e.gradient,o=e.back;e.reset;function i(){o?t.goBack():t.push(n)}return c?Object(s.jsx)(I,{className:r,onClick:i,children:a}):Object(s.jsx)(k,{className:r,onClick:i,children:a})})),z=function(e){e.path;var t=e.darker,n=e.anchored;e.history;return Object(s.jsx)(P,{className:"GoBack ".concat(t?"Button--Darker":""," ").concat(n?"GoBack--Anchored":""),back:!0,children:Object(s.jsxs)("span",{className:"GoBackText",children:[Object(s.jsx)(A.a,{icon:E.a,style:{color:"#A6CE56"},className:"BackArrow"}),"GO BACK"]})})};function R(){return Object(s.jsx)("div",{className:"Container",children:Object(s.jsxs)("div",{className:"SignUpBox",children:[Object(s.jsx)(z,{path:"/login"}),Object(s.jsx)(L,{})]})})}var H=function(e){var t=e.onLoginChanged;return Object(s.jsx)(l.a,{children:Object(s.jsxs)(d.d,{children:[Object(s.jsx)(d.b,{exact:!0,path:"/",children:Object(s.jsx)(C,{onLoginChanged:t})}),Object(s.jsx)(d.b,{path:"/signup",children:Object(s.jsx)(R,{})}),Object(s.jsx)(d.b,{path:"/",children:Object(s.jsx)(d.a,{to:"/"})})]})})},U=(n(50),n(39)),B=n.n(U),F=n(57),G=(n(51),function(e){var t=e.src,n=e.className,a=e.small,r=(e.slim,a?"ProfilePicHeader":"ProfilePic");return Object(s.jsx)("img",{className:"".concat(r," ").concat(null!==n&&void 0!==n?n:""),src:t,alt:"Profile"})}),Z=(n(52),Object(d.h)((function(e){var t=e.history;return Object(s.jsxs)("div",{className:"HeaderTitle",onClick:function(){return t.push("/")},children:[Object(s.jsx)("span",{className:"TeamWord",children:"TEAM"}),Object(s.jsx)("span",{className:"WorksWord",children:"WORKS"})]})}))),Y=function(){var e=Object(F.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.logout(),window.location.reload(!1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(e){var t,n=e.nosearchbar,r=e.handleSearch,c=Object(a.useState)(""),o=Object(i.a)(c,2),l=o[0],d=o[1];return t=n?Object(s.jsx)(P,{className:"Button--green HeaderButton",path:"/",children:"Go to Inbox"}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("label",{className:"HeaderSearchbar",children:Object(s.jsx)("form",{onSubmit:function(e){e.preventDefault(),r(l)},children:Object(s.jsx)("input",{className:"SearchInput",onChange:function(e){d(e.target.value)},placeholder:"Search for messages"})})}),Object(s.jsx)(P,{className:"Button--green HeaderButton",path:"/settings",children:"Manage team"})]}),Object(s.jsxs)("div",{className:"Header",children:[Object(s.jsx)(Z,{}),t,Object(s.jsx)(k,{className:"Button--red HeaderButtonLogout",onClick:Y,children:Object(s.jsx)("img",{className:"LogoutIcon",src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnN2Z2pzPSJodHRwOi8vc3ZnanMuY29tL3N2Z2pzIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeD0iMCIgeT0iMCIgdmlld0JveD0iMCAwIDQ4OS44ODggNDg5Ljg4OCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjUuMzgzLDI5MC41Yy03LjItNzcuNSwyNS45LTE0Ny43LDgwLjgtMTkyLjNjMjEuNC0xNy40LDUzLjQtMi41LDUzLjQsMjVsMCwwYzAsMTAuMS00LjgsMTkuNC0xMi42LDI1LjcgICAgYy0zOC45LDMxLjctNjIuMyw4MS43LTU2LjYsMTM2LjljNy40LDcxLjksNjUsMTMwLjEsMTM2LjgsMTM4LjFjOTMuNywxMC41LDE3My4zLTYyLjksMTczLjMtMTU0LjVjMC00OC42LTIyLjUtOTIuMS01Ny42LTEyMC42ICAgIGMtNy44LTYuMy0xMi41LTE1LjYtMTIuNS0yNS42bDAsMGMwLTI3LjIsMzEuNS00Mi42LDUyLjctMjUuNmM1MC4yLDQwLjUsODIuNCwxMDIuNCw4Mi40LDE3MS44YzAsMTI2LjktMTA3LjgsMjI5LjItMjM2LjcsMjE5LjkgICAgQzEyMi4xODMsNDgxLjgsMzUuMjgzLDM5Ni45LDI1LjM4MywyOTAuNXogTTI0NC44ODMsMGMtMTgsMC0zMi41LDE0LjYtMzIuNSwzMi41djE0OS43YzAsMTgsMTQuNiwzMi41LDMyLjUsMzIuNSAgICBzMzIuNS0xNC42LDMyLjUtMzIuNVYzMi41QzI3Ny4zODMsMTQuNiwyNjIuODgzLDAsMjQ0Ljg4MywweiIgZmlsbD0iI2ZmM2MzYyIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgc3R5bGU9IiIgY2xhc3M9IiI+PC9wYXRoPgoJPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjwvZz48L3N2Zz4="})})]})},J=function(){var e=Object(d.g)().pathname;return Object(a.useEffect)((function(){window.scrollTo(0,0)}),[e]),null},Q="/user",W={getUserById:function(e){return x.get("/user?userId="+e)},getUsers:function(){return x.get("/users")},registerUser:function(e){return x.post("/user/create",e)},updateUser:function(e){return x.post("/user/update",e)},deleteUser:function(e){return x.delete(Q+"/delete?userId=".concat(e))},getCredentials:function(){return x.get("/user/credentials")}},V=r.a.createContext({}),_=function(e){var t=e.children,n=Object(a.useState)({isDepartmentManager:function(){return!1},isProjectManager:function(){return!1},getRoleName:function(){return"Member"}}),r=Object(i.a)(n,2),c=r[0],o=r[1];return Object(a.useEffect)((function(){W.getCredentials().then((function(e){e.isDepartmentManager=function(t){var n;if(t=Number(t),e.isTeamManager)return!0;var s=null===(n=e.currentDepartments)||void 0===n?void 0:n.find((function(e){return e.id===t}));return!!s&&s.isDepartmentManager},e.isProjectManager=function(t,n){var s;if(t=Number(t),n=Number(n),e.isTeamManager)return!0;if(n&&e.isDepartmentManager(n))return!0;var a=null===(s=e.currentProjects)||void 0===s?void 0:s.find((function(e){return e.id===t}));return!!a&&a.isProjectManager},e.getRoleName=function(){var t,n,s="Member";return e.isTeamManager?s="Team manager":(null===(t=e.currentDepartments)||void 0===t?void 0:t.some((function(e){return e.isDepartmentManager&&null===e.finalDate})))?s="Department manager":(null===(n=e.currentProjects)||void 0===n?void 0:n.some((function(e){return e.isProjectManager&&null===e.finalDate})))&&(s="Project manager"),s},console.log(e),o(e)})).catch((function(e){return console.error(e)}))}),[]),Object(s.jsx)(V.Provider,{value:c,children:t})},K="/message",$={getMyInboxMessages:function(){return x.get("/message/inbox")},getMySentMessages:function(){return x.get("/message/sent")},getMyMessagesByTag:function(e){return x.get("/message/byTag?tagId="+e)},getMyMessagesBySearch:function(e){return x.get("/message/bySearch?search="+e)},getNumberOfNotReadMessages:function(){return x.get("/message/noRead")},getNumberOfNoReadMessagesByTag:function(e){return x.get("/message/noReadByTag?tagId="+e)},newMessage:function(e){return x.post(K,e)},replyMessage:function(e,t){return x.post("/message/reply?repliedMessageId="+t,e)},forwardMessage:function(e,t){return x.post("/message/forward?forwardedMessageId="+t,e)},markMessageAsRead:function(e){return x.post("/message/markAsRead?messageId="+e)}},X=(n(53),function(e){var t=e.color,n=e.className;return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("div",{className:"Circle ".concat(n),style:{background:t}})})}),ee=n(29),te=function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors),t=Object.keys(s.state.inputs).length;return e.length<t||e.some((function(e){return""!==e}))},s.validateAll=function(){Object.entries(s.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];s.validate(n,a)}))},s.validate=function(e,t){s.setState({requestError:""});var n="";switch(e){case"recipientsEmails":t===[]&&(n="Recipients required")}s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},Object(u.a)({},e,n))})},s.changeHandler=function(e,t){s.validate(e,t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},Object(u.a)({},e,t))})},s.apiRequestHandler=function(e){console.log("Forwarding to:"),console.log(e),$.forwardMessage(e,s.forwardedMessage.id).then((function(){console.log("Mensaje enviado")})).catch((function(e){console.log("ERROR: no se pudo reenviar el mensaje")}))},s.submitHandler=function(e){if(e.preventDefault(),s.validateAll(),s.hasErrors())console.log("There are errors in this form"),console.log(s.state.errors);else{var t=s.state.inputs.recipientsEmails;s.apiRequestHandler(t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},{recipientsEmails:""})}),s.setOpenMessage("")}},s.state={inputs:{recipientsEmails:""},errors:{},requestError:""},s.forwardedMessage=e.forwardedMessage,s.forwardOptions=e.forwardOptions,s.setOpenMessage=e.setOpenMessage,s}return Object(m.a)(n,[{key:"render",value:function(){var e=this;return Object(s.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(s.jsx)("div",{className:"MsgContentInput",children:Object(s.jsx)(ee.a,{options:this.forwardOptions,onChange:function(t){e.changeHandler("recipientsEmails",t.map((function(e){return e.value})))},styles:ne,placeholder:"Select the recipients",isMulti:!0})}),Object(s.jsx)("div",{className:"MsgContentButtons",children:Object(s.jsx)(I,{onClick:this.submitHandler,className:"GradientButton--OpenMessage",children:"Send"})})]})}}]),n}(r.a.Component),ne={option:function(e,t){return Object(j.a)(Object(j.a)({},e),{},{color:"#a6ce56",width:700})},control:function(e,t){return Object(j.a)(Object(j.a)({},e),{},{background:"#262626",borderRadius:4,borderColor:"rgba(166, 206, 86, 0.8)",boxShadow:(t.isFocused,null),marginBottom:10})},dropdownIndicator:function(e){return Object(j.a)(Object(j.a)({},e),{},{fill:"#a6ce56",stroke:"#a6ce56"})},menu:function(e){return Object(j.a)(Object(j.a)({},e),{},{backgroundColor:"#292d22"})},multiValue:function(e){return Object(j.a)(Object(j.a)({},e),{},{backgroundColor:"#a6ce56"})},multiValueLabel:function(e){return Object(j.a)(Object(j.a)({},e),{},{color:"white"})}},se=function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors),t=Object.keys(s.state.inputs).length;return e.length<t||e.some((function(e){return""!==e}))},s.validateAll=function(){Object.entries(s.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];s.validate(n,a)}))},s.validate=function(e,t){s.setState({requestError:""});var n="";switch(e){case"text":""===t&&(n="Text required")}s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},Object(u.a)({},e,n))})},s.changeHandler=function(e,t){s.validate(e,t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},Object(u.a)({},e,t))})},s.apiRequestHandler=function(e){var t={recipientsEmails:[s.repliedMessage.strippedSender.email],subject:"Re: "+s.repliedMessage.subject,text:e,read:!1,toDoList:[],tagList:[]};console.log("Replying:"),console.log(t),$.replyMessage(t,s.repliedMessage.id).then((function(){console.log("Mensaje enviado")})).catch((function(e){console.log("ERROR: no se pudo responder el mensaje")}))},s.submitHandler=function(e){if(e.preventDefault(),s.validateAll(),s.hasErrors())console.log("There are errors in this form"),console.log(s.state.errors);else{var t=s.state.inputs.text;s.apiRequestHandler(t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},{text:""})}),s.setOpenMessage("")}},s.state={inputs:{text:""},errors:{},requestError:""},s.repliedMessage=e.repliedMessage,s.setOpenMessage=e.setOpenMessage,s}return Object(m.a)(n,[{key:"render",value:function(){return Object(s.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(s.jsx)("div",{className:"MsgContentInput",children:Object(s.jsx)(T,{name:"text",type:"text",value:this.state.inputs.text,placeholder:"Write your reply",styleClass:"Input ReplyInput",error:this.state.errors.text,changeHandler:this.changeHandler})}),Object(s.jsx)("div",{className:"MsgContentButtons",children:Object(s.jsx)(I,{onClick:this.submitHandler,className:"GradientButton--OpenMessage",children:"Reply"})})]})}}]),n}(r.a.Component),ae="/toDos",re={getToDos:function(e){return x.get("/toDos?milestoneId="+e)},getMyToDos:function(e){return x.get("/toDos/mine?milestoneId="+e)},getAllMyToDos:function(){return x.get("/toDos/mine/all")},addNewPersonalToDo:function(e,t){return x.post("/toDos/mine/create?milestoneId="+e,t)},markToDoAsDone:function(e,t){return x.post(ae+"/markAsDone?unmark=".concat(t?1:0,"&toDoId=").concat(e))},createTodo:function(e,t){return x.post("/toDos/create?milestoneId="+e,t)},assignTodo:function(e,t,n){return x.post(ae+"/assign?todoId=".concat(t,"&milestoneId=").concat(e,"&assigneeId=").concat(n))},updateTitle:function(e,t){return x.post(ae+"/updateTitle?todoId=".concat(t.id,"&milestoneId=").concat(e),t)},setTags:function(e,t,n){return x.post(ae+"/setTags?todoId=".concat(t,"&milestoneId=").concat(e),n)},deleteTodo:function(e,t){return x.delete(ae+"/delete?milestoneId=".concat(e,"&toDoId=").concat(t))}},ce=function(e){var t=e.isDone,n=e.markAsDone;return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("button",{className:"ToDoCircle",onClick:n,children:t&&Object(s.jsx)(A.a,{icon:E.b})})})},oe=function(e){var t=e.id,n=e.tagList,r=e.title,c=e.done,o=e.blocked,l=Object(a.useState)(c),d=Object(i.a)(l,2),u=d[0],j=d[1],b=Object(a.useState)(c),m=Object(i.a)(b,2),h=m[0],O=m[1],g=function(){o||(O(!0),console.log("Marking the toDo as done"),setTimeout((function(){return re.markToDoAsDone(t).then((function(){j(!0)})).catch((function(e){console.log("ERROR: cannot mark the todo as done"),O(!1)}))}),700))};return Object(s.jsxs)("div",{className:"ToDoTab",onClick:g,hidden:!o&&u,children:[Object(s.jsx)(ce,{isDone:h,markAsDone:g})," ",Object(s.jsxs)("span",{style:{textDecoration:h?"line-through":"none"},children:[r," "]}),Object(s.jsx)("div",{style:{float:o?"":"right",display:o?"inline-block":"",marginLeft:"15px"},children:n.map((function(e){return Object(s.jsx)(X,{color:e.color},e.color)}))})]})},ie=function(e){return console.log(e.url),Object(s.jsx)("a",{href:""+e.url,target:"_blank",children:Object(s.jsx)("div",{className:"FilePreview",onClick:null,children:Object(s.jsx)(A.a,{icon:E.d})})})},le=function(e){var t=e.msg,n=e.setOpenMessage,r=Object(a.useState)([]),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(a.useState)(""),u=Object(i.a)(d,2),j=u[0],b=u[1];return Object(a.useEffect)((function(){"Forward"===j&&W.getUsers().then((function(e){console.log("Getting user mails");var t=e.map((function(e){return{label:e.name+" - "+e.email,value:e.email}}));l(t),console.log(t)})).catch((function(e){console.log("ERROR: cannot get the users mails")}))}),[j]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"MsgContentSentTo",children:Object(s.jsxs)("span",{style:{fontWeight:"bold"},children:["Sent to"," ",t.strippedRecipients.map((function(e){return Object(s.jsxs)("b",{children:[" ",e.name," "]},e.name)}))]})}),Object(s.jsx)("div",{className:"MsgContentText",dangerouslySetInnerHTML:{__html:t.text.replace(/\n/g,"<br>")}}),Object(s.jsxs)("div",{className:"MsgContentButtons",children:[Object(s.jsx)(I,{onClick:function(){b("Reply"===j?"":"Reply")},className:"GradientButton--ReFor ",children:Object(s.jsx)(A.a,{icon:E.f})}),Object(s.jsx)(I,{onClick:function(){b("Forward"===j?"":"Forward")},className:"GradientButton--ReFor",children:Object(s.jsx)(A.a,{icon:E.c})})]}),Object(s.jsx)("div",{className:"MsgContentToDos",children:t.toDos.map((function(e){return Object(s.jsx)(oe,{id:e.id,tagList:e.tags,title:e.title,done:e.done,blocked:!0},e.id)}))}),Object(s.jsx)("div",{className:"MsgContentFiles",children:t.attatchments.map((function(e){return Object(s.jsx)(ie,{id:e.id,url:e.url},e.id)}))}),"Reply"===j&&Object(s.jsx)(se,{repliedMessage:t,setOpenMessage:n}),"Forward"===j&&Object(s.jsx)(te,{forwardOptions:o,forwardedMessage:t,setOpenMessage:n},JSON.stringify(o))]})},de=function(e){var t=e.msg,n=e.openMessage,r=e.setOpenMessage,c=e.setReloadCounters,o=Object(a.useState)(),l=Object(i.a)(o,2),d=l[0],u=l[1];Object(a.useEffect)((function(){u(t.read)}),[t]);var j=function(){return n===t.id};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:j()?"MsgPreviewContainer MsgPreviewContainer--Active":d?"MsgPreviewContainer MsgPreviewContainer--Read":"MsgPreviewContainer",onClick:function(){j()?r(""):r(t.id),c(!0),d||$.markMessageAsRead(t.id).then((function(e){u(!0)})).catch((function(e){console.log("ERROR: You cannot mark this message as read")}))},children:[Object(s.jsx)("div",{className:"SelectBox"}),Object(s.jsxs)("h4",{className:"MsgTitle",children:[t.strippedSender.name?t.strippedSender.name:"Usuario"," ",t.strippedSender.lastname?t.strippedSender.lastname:"Eliminado"," ","-"," "]}),Object(s.jsxs)("h5",{className:"MsgSubject",children:[" ",t.subject," "]}),Object(s.jsx)("h5",{className:"MsgDateTime",style:{float:"right"},children:t.timestamp}),Object(s.jsx)("div",{className:"MsgTags",style:{float:"right"},children:t.tags.map((function(e){return Object(s.jsx)(X,{color:e.color},e.id)}))})]}),Object(s.jsx)("div",{className:j()?"MsgContent":"MsgContent MsgContent--Collapsed",children:Object(s.jsx)(le,{msg:t,setOpenMessage:r},t.id)})]})},ue=(n(100),function(e){var t=e.setReloadCounters,n=e.messages,r=Object(a.useState)(""),c=Object(i.a)(r,2),o=c[0],l=c[1];if(!n)return Object(s.jsx)(S,{});var d=n.map((function(e){return Object(s.jsx)(de,{msg:e,openMessage:o,setOpenMessage:l,setReloadCounters:t},e.id)}));return Object(s.jsx)("div",{className:"MsgListContainer",children:d})}),je="/tags",be={getTags:function(e){return x.get("/tags?projectId="+e)},getAllMyTags:function(){return x.get("/tags/mine/all")},addNewTag:function(e,t){return x.post("/tags/create?projectId="+e,t)},deleteTag:function(e,t){return x.delete(je+"/delete?projectId=".concat(e,"&tagId=").concat(t))}},me=function(e){var t=e.children,n=e.color,a=e.selected,r=e.onClick,c=e.inline,o=e.unselectable,i=e.light,l="TagTab ".concat(i?"TagTab--Light":""," ").concat(a?"TagTab--Selected":""," ").concat(c?"TagTab--Inline":""," ").concat(o?"TagTab--Unselectable":"");return n?Object(s.jsxs)("div",{className:l,onClick:r,children:[Object(s.jsx)(X,{className:"TagTab__Circle",color:a?"#20290f":n}),t]}):Object(s.jsx)("div",{className:l,onClick:r,children:t})},he=function(e,t){e.value;var n=e.label,a=e.tagColor,r=e.project,c="value"===t.context,o=c?"#222":"#a6ce56";if(a){var i=n;return r&&(i+="\u2013 ".concat(r)),Object(s.jsx)("div",{style:{display:"flex"},children:Object(s.jsx)("div",{children:Object(s.jsx)(me,{light:c,inline:!0,unselectable:!0,color:a,children:i})})})}return Object(s.jsx)("div",{style:{display:"flex"},children:Object(s.jsx)("div",{style:{color:o},children:n})})},Oe={option:function(e,t){return Object(j.a)(Object(j.a)({},e),{},{color:"#a6ce56",background:t.isFocused?"#ccc2":null})},control:function(e,t){return Object(j.a)(Object(j.a)({},e),{},{background:"#262626",borderRadius:4,borderColor:"rgba(166, 206, 86, 0.8)",boxShadow:(t.isFocused,null),marginBottom:10})},dropdownIndicator:function(e){return Object(j.a)(Object(j.a)({},e),{},{fill:"#a6ce56",stroke:"#a6ce56"})},menu:function(e){return Object(j.a)(Object(j.a)({},e),{},{backgroundColor:"#292d22"})},multiValue:function(e){return Object(j.a)(Object(j.a)({},e),{},{backgroundColor:"#a6ce56"})},valueContainer:function(e){return Object(j.a)(Object(j.a)({},e),{},{flexDirection:"row",flexWrap:"nowrap"})},multiValueLabel:function(e){return Object(j.a)(Object(j.a)({},e),{},{color:"#262626"})}},ge=function(e){var t=e.name,n=e.placeholder,a=e.options,r=e.defaultOptions,c=e.changeHandler,o=e.className,i=e.error;return Object(s.jsxs)("div",{className:"InputContainer ".concat(o),style:{marginBottom:"0px"},children:[Object(s.jsx)("p",{className:"TitleNewMsg",children:t}),Object(s.jsx)(ee.a,{formatOptionLabel:he,options:a,defaultValue:r,onChange:function(e){c(t,e.map((function(e){return e.value})))},styles:Oe,name:t,placeholder:n,isMulti:!0}),i&&Object(s.jsx)(N,{error:i})]})};function pe(e){var t=e.name,n=e.changeHandler,a=e.error;return Object(s.jsxs)("div",{className:"NewMsgTextLabel",children:[Object(s.jsx)("span",{className:"NewMsgBodyText",children:t}),Object(s.jsx)("textarea",{name:t,className:"Input NewMsgBody InputNewMsg",form:"NewMsgForm",onChange:function(e){return n(t,e.target.value)}}),Object(s.jsx)(N,{error:a})]})}var fe=function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors),t=Object.keys(s.state.inputs).length;return e.length<t-3||e.some((function(e){return""!==e}))},s.validateAll=function(){Object.entries(s.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];s.validate(n,a)}))},s.validate=function(e,t){s.setState({requestError:""});var n="";switch(e){case"To":(t.length<1||""===t)&&(n="Select one recipient at least");break;case"Subject":t.length>100&&(n="Too Long Subject ("+(100-t.length)+")");break;case"Message":""===t&&(n="Message required"),t.length>750&&(n="The Message is too Long ("+(750-t.length)+")")}s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},Object(u.a)({},e,n))})},s.changeHandler=function(e,t){s.validate(e,t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},Object(u.a)({},e,t))})},s.changeFile=function(e){s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},{File:e})})},s.apiRequestHandler=function(e,t,n,s,a,r){console.log("Sending: "),console.log(r);for(var c=new FormData,o=0;o<=r.length-1;o++)c.append("files",r[o]);var i={recipientsEmails:e,subject:t,text:n,read:!1,toDoList:s&&""!==s?s:[],tagList:a&&""!==a?a:[]};c.append("message",new Blob([JSON.stringify(i)],{type:"application/json"})),console.log(i),p()({method:"POST",url:"/api/message",data:c,headers:{"Content-Type":"multipart/form-data"}})},s.submitHandler=function(e){if(e.preventDefault(),s.validateAll(),s.hasErrors())console.log("There are errors in this form"),console.log(s.state.errors);else{var t=s.state.inputs.To,n=s.state.inputs.Subject,a=s.state.inputs.Message,r=s.state.inputs.ToDos,c=s.state.inputs.Tags,o=s.state.inputs.File;s.apiRequestHandler(t,n,a,r,c,o),s.ChangeModalNewMessage()}},s.state={inputs:{To:"",Tags:"",Subject:"",ToDos:"",Message:"",File:""},errors:{},requestError:""},s.ChangeModalNewMessage=e.ChangeModalNewMessage,s.mailOptions=e.mailOptions,s.toDoOptions=e.toDoOptions,s.tagOptions=e.tagOptions,s.fileRef=Object(a.createRef)(null),s}return Object(m.a)(n,[{key:"render",value:function(){var e=this;return Object(s.jsxs)("form",{onSubmit:this.submitHandler,className:"NewMsgForm",children:[Object(s.jsx)(ge,{name:"To",placeholder:"Users",changeHandler:this.changeHandler,options:this.mailOptions,error:this.state.errors.To}),Object(s.jsxs)("div",{className:"SecondLineFlex",children:[Object(s.jsx)(ge,{name:"Tags",placeholder:"Tags",changeHandler:this.changeHandler,options:this.tagOptions,className:"InputContainer2"}),Object(s.jsx)(ge,{name:"ToDos",placeholder:"ToDos",options:this.toDoOptions,changeHandler:this.changeHandler,className:"InputContainer2"})]}),Object(s.jsxs)("div",{className:"NewMsg",children:[Object(s.jsxs)("div",{className:"NewMsgHeadLabel",children:[Object(s.jsx)("span",{className:"NewMsgHeadText",children:"Subject"}),Object(s.jsx)(T,{name:"Subject",styleClass:"Input NewMsgHead InputNewMsg",placeholder:"How are you?",error:this.state.errors.Subject,changeHandler:this.changeHandler})]}),Object(s.jsx)(pe,{name:"Message",error:this.state.errors.Message,changeHandler:this.changeHandler})]}),Object(s.jsxs)("div",{className:"NewMsgSendOptions",children:[Object(s.jsx)("input",{id:"files",type:"file",ref:this.fileRef,multiple:!0,onChange:function(t){return e.changeFile(t.target.files)},hidden:!0}),Object(s.jsx)("img",{className:"NewMsgUpload",src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnN2Z2pzPSJodHRwOi8vc3ZnanMuY29tL3N2Z2pzIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeD0iMCIgeT0iMCIgdmlld0JveD0iMCAwIDQ3NS4wNzggNDc1LjA3NyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+Cgk8Zz4KCQk8cGF0aCBkPSJNNDY3LjA4MSwzMjcuNzY3Yy01LjMyMS01LjMzMS0xMS43OTctNy45OTQtMTkuNDExLTcuOTk0aC0xMjEuOTFjLTMuOTk0LDEwLjY1Ny0xMC43MDUsMTkuNDExLTIwLjEyNiwyNi4yNjIgICAgYy05LjQyNSw2Ljg1Mi0xOS45MzgsMTAuMjgtMzEuNTQ2LDEwLjI4aC03My4wOTZjLTExLjYwOSwwLTIyLjEyNi0zLjQyOS0zMS41NDUtMTAuMjhjLTkuNDIzLTYuODUxLTE2LjEzLTE1LjYwNC0yMC4xMjctMjYuMjYyICAgIEgyNy40MDhjLTcuNjEyLDAtMTQuMDgzLDIuNjYzLTE5LjQxNCw3Ljk5NEMyLjY2NCwzMzMuMDkyLDAsMzM5LjU2MywwLDM0Ny4xNzh2OTEuMzYxYzAsNy42MSwyLjY2NCwxNC4wODksNy45OTQsMTkuNDEgICAgYzUuMzMsNS4zMjksMTEuODAxLDcuOTkxLDE5LjQxNCw3Ljk5MWg0MjAuMjY2YzcuNjEsMCwxNC4wODYtMi42NjIsMTkuNDEtNy45OTFjNS4zMzItNS4zMjgsNy45OTQtMTEuOCw3Ljk5NC0xOS40MXYtOTEuMzYxICAgIEM0NzUuMDc4LDMzOS41NjMsNDcyLjQxNiwzMzMuMDk5LDQ2Ny4wODEsMzI3Ljc2N3ogTTM2MC4wMjUsNDIzLjk3OGMtMy42MjEsMy42MTctNy45MDUsNS40MjgtMTIuODU0LDUuNDI4ICAgIHMtOS4yMjctMS44MTEtMTIuODQ3LTUuNDI4Yy0zLjYxNC0zLjYxMy01LjQyMS03Ljg5OC01LjQyMS0xMi44NDdzMS44MDctOS4yMzYsNS40MjEtMTIuODQ3YzMuNjItMy42MTMsNy44OTgtNS40MjgsMTIuODQ3LTUuNDI4ICAgIHM5LjIzMiwxLjgxNCwxMi44NTQsNS40MjhjMy42MTMsMy42MSw1LjQyMSw3Ljg5OCw1LjQyMSwxMi44NDdTMzYzLjYzOCw0MjAuMzY0LDM2MC4wMjUsNDIzLjk3OHogTTQzMy4xMDksNDIzLjk3OCAgICBjLTMuNjE0LDMuNjE3LTcuODk4LDUuNDI4LTEyLjg0OCw1LjQyOGMtNC45NDgsMC05LjIyOS0xLjgxMS0xMi44NDctNS40MjhjLTMuNjEzLTMuNjEzLTUuNDItNy44OTgtNS40Mi0xMi44NDcgICAgczEuODA3LTkuMjM2LDUuNDItMTIuODQ3YzMuNjE3LTMuNjEzLDcuODk4LTUuNDI4LDEyLjg0Ny01LjQyOGM0Ljk0OSwwLDkuMjMzLDEuODE0LDEyLjg0OCw1LjQyOCAgICBjMy42MTcsMy42MSw1LjQyNyw3Ljg5OCw1LjQyNywxMi44NDdTNDM2LjcyOSw0MjAuMzY0LDQzMy4xMDksNDIzLjk3OHoiIGZpbGw9IiNhN2UzMmQiIGRhdGEtb3JpZ2luYWw9IiMwMDAwMDAiIHN0eWxlPSIiPjwvcGF0aD4KCQk8cGF0aCBkPSJNMTA5LjYzMiwxNzMuNTloNzMuMDg5djEyNy45MDljMCw0Ljk0OCwxLjgwOSw5LjIzMiw1LjQyNCwxMi44NDdjMy42MTcsMy42MTMsNy45LDUuNDI3LDEyLjg0Nyw1LjQyN2g3My4wOTYgICAgYzQuOTQ4LDAsOS4yMjctMS44MTMsMTIuODQ3LTUuNDI3YzMuNjE0LTMuNjE0LDUuNDIxLTcuODk4LDUuNDIxLTEyLjg0N1YxNzMuNTloNzMuMDkxYzcuOTk3LDAsMTMuNjEzLTMuODA5LDE2Ljg0NC0xMS40MiAgICBjMy4yMzctNy40MjIsMS45MDItMTMuOTktMy45OTctMTkuNzAxTDI1MC4zODUsMTQuNTYyYy0zLjQyOS0zLjYxNy03LjcwNi01LjQyNi0xMi44NDctNS40MjZjLTUuMTM2LDAtOS40MTksMS44MDktMTIuODQ3LDUuNDI2ICAgIEw5Ni43ODYsMTQyLjQ2OWMtNS45MDIsNS43MTEtNy4yMzMsMTIuMjc1LTMuOTk5LDE5LjcwMUM5Ni4wMjYsMTY5Ljc4NSwxMDEuNjQsMTczLjU5LDEwOS42MzIsMTczLjU5eiIgZmlsbD0iI2E3ZTMyZCIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgc3R5bGU9IiI+PC9wYXRoPgoJPC9nPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjwvZz48L3N2Zz4=",onClick:function(){return e.fileRef.current.click()}}),Object(s.jsx)(w,{text:"Send",className:"NewMsgSendButton",requestError:this.state.requestError,hasErrors:this.hasErrors()})]})]})}}]),n}(r.a.Component),xe=function(e){var t=e.ChangeModalNewMessage,n=Object(a.useState)([]),r=Object(i.a)(n,2),c=r[0],o=r[1],l=Object(a.useState)([]),d=Object(i.a)(l,2),u=d[0],j=d[1],b=Object(a.useState)([]),m=Object(i.a)(b,2),h=m[0],O=m[1];return Object(a.useEffect)((function(){W.getUsers().then((function(e){console.log("Getting user mail options");var t=e.map((function(e){return{label:e.name+" - "+e.email,value:e.email}}));o(t),console.log(t)})).catch((function(e){console.log("ERROR: cannot get the users mails"),console.log(e)}))}),[t]),Object(a.useEffect)((function(){be.getAllMyTags().then((function(e){console.log("Getting user tags options");var t=Object.entries(e).map((function(e){return e[1].map((function(t){return{label:t.title+": ("+e[0]+")",value:t.id}}))}));console.log(t[0]),O(t[0])})).catch((function(e){console.log("ERROR: cannot get the user's tags"),console.log(e)}))}),[t]),Object(a.useEffect)((function(){re.getAllMyToDos().then((function(e){console.log("Getting user toDos");var t=Object.entries(e).map((function(e){return e[1].map((function(t){return{label:t.title+": ("+e[0]+")",value:t.id}}))}));console.log(t[0]),j(t[0])})).catch((function(e){console.log("ERROR: cannot get the user's todos"),console.log(e)}))}),[t]),Object(s.jsx)("div",{className:"NewMsgModal",children:Object(s.jsxs)("div",{className:"NewMsgContainer",children:[Object(s.jsx)("div",{onClick:t,style:{display:"block",marginBottom:"10px"},children:Object(s.jsx)(A.a,{icon:E.g,size:"10x",style:{float:"right",fontSize:"18"}})}),Object(s.jsx)(fe,{mailOptions:c,toDoOptions:u,tagOptions:h,ChangeModalNewMessage:t},JSON.stringify(c+u+h))]})})},Me=(n(101),function(e){return Object(s.jsx)("div",{className:"Sidebar",children:e.children})}),ve=(n(54),function(e){var t=e.text,n=e.selectedTab,a=e.setSelectedTab,r=e.isTag,c=e.children,o=r?"SidebarTab SidebarTab--Tag":"SidebarTab";return n===t&&(o+=" SidebarTab--Selected"),Object(s.jsx)("div",{className:o,onClick:function(){return a(t)},children:c})}),Ne=function(e){var t=e.numberOfInboxMessages,n=e.numberOfSentMessages,a=e.selectedTab,r=e.setSelectedTab;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h3",{className:"SidebarSectionTitle",children:"Inboxes"}),Object(s.jsxs)(ve,{text:"Inbox",selectedTab:a,setSelectedTab:r,isTag:!1,children:["Inbox",Object(s.jsx)("span",{style:{float:"right"},children:t})]}),Object(s.jsxs)(ve,{text:"Sent",selectedTab:a,setSelectedTab:r,isTag:!1,children:["Sent",Object(s.jsx)("span",{style:{float:"right"},children:n})]})]})},Te="/departments",ye={getDepartments:function(){return x.get(Te)},postDepartment:function(e){return x.post("/departments/create",e)},updateDepartment:function(e){return x.patch(Te+"/update?departmentId=".concat(e.id),e)},deleteDepartment:function(e){return x.delete("/departments/"+e+"/delete")},getMyDepartments:function(){return x.get("/departments/mine")},addUserToDepartment:function(e,t,n){return void 0!==n?x.post("/departments/belongs"+"/create?departmentId=".concat(e,"&belongUserId=").concat(t,"&isDepartmentManager=").concat(n)):x.post("/departments/belongs"+"/create?departmentId=".concat(e,"&belongUserId=").concat(t))},removeUserFromDepartment:function(e,t){return x.delete("/departments/belongs"+"/delete?departmentId=".concat(e,"&belongUserId=").concat(t))},getMembersFromDepartment:function(e){return x.get("/departments/belongs"+"?departmentId=".concat(e))}},Ie="/projects",Se={getProjects:function(e){return x.get(Ie+"?departmentId=".concat(e))},getMyProjects:function(e){return x.get("/projects/mine?departmentId="+e)},postProject:function(e,t){return x.post(Ie+"/create?departmentId=".concat(e),t)},updateProject:function(e,t,n){return x.patch(Ie+"/update?departmentId=".concat(e,"&projectId=").concat(t),n)},deleteProject:function(e,t){return x.delete(Ie+"/delete?departmentId=".concat(e,"&projectId=").concat(t))},addUserToProject:function(e,t,n){return void 0!==n?x.post("/projects/participation"+"/create?projectId=".concat(e,"&participationUserId=").concat(t,"&willBeProjectManager=").concat(n)):x.post("/projects/participation"+"/create?projectId=".concat(e,"&participationUserId=").concat(t))},removeUserFromProject:function(e,t){return x.delete("/projects/participation"+"/delete?projectId=".concat(e,"&participationUserId=").concat(t))},getMembersFromProject:function(e){return x.get("/projects/participation"+"?projectId=".concat(e))}},we=(n(102),function(e){var t=e.pickedProject,n=e.setPickedProject,r=Object(a.useState)([]),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(a.useState)([]),u=Object(i.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(null),h=Object(i.a)(m,2),O=h[0],g=h[1],p=Object(a.useState)({}),f=Object(i.a)(p,2),x=f[0],M=f[1],v=Object(a.useState)(!1),N=Object(i.a)(v,2),T=N[0],y=N[1];Object(a.useEffect)((function(){ye.getMyDepartments().then((function(e){l(e)})).catch((function(e){console.log("ERROR: cannot get the departments")}))}),[]),Object(a.useEffect)((function(){null!==O&&Se.getMyProjects(O.id).then((function(e){b(e)})).catch((function(e){console.log("ERROR: cannot get the projects")}))}),[]);var I=function(){y(!T)};return Object(s.jsxs)("div",{style:{display:o<=0?"none":""},children:[Object(s.jsx)("h3",{className:"SidebarSectionTitle",children:"Project"}),Object(s.jsxs)("button",{className:"PickerBox",onClick:I,children:[null===O||void 0===O?void 0:O.name," - ",null===t||void 0===t?void 0:t.name]}),Object(s.jsxs)("div",{className:"CollapsedDPTPicker",style:{maxHeight:T?"none":"0px"},children:[Object(s.jsx)("div",{className:"DepartmentPicker",children:o.map((function(e){return Object(s.jsx)("button",{className:"CollapsedSelector",onClick:function(){return function(e){console.log("GETTIN PROJECTS"),M(e),Se.getMyProjects(e.id).then((function(e){b(e)})).catch((function(e){console.log("ERROR: cannot get the projects")}))}(e)},children:e.name},e.id)}))}),Object(s.jsx)("div",{className:"ProjectPicker",children:j.map((function(e){return Object(s.jsx)("button",{className:"CollapsedSelector",onClick:function(){return function(e){g(x),n(e),I()}(e)},children:e.name},e.id)}))})]})]})}),De=(n(103),function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors);Object.keys(s.state.inputs).length;return e.some((function(e){return""!==e}))},s.validate=function(e){s.setState({requestError:""});var t="";""===e?t="ToDo required":e.length>30&&(t="Too Long toDo"),s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},{toDo:t})})},s.changeHandler=function(e,t){s.validate(t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},{toDo:t})})},s.apiRequestHandler=function(e){re.addNewPersonalToDo(s.props.milestoneId,{title:e,done:!1}).then((function(e){s.props.setReloadToDos(!0)})).catch((function(e){console.log("ERROR: cannot add the new todo"),console.log(e.response),s.setState({requestError:e.response.data})}))},s.submitHandler=function(e){if(e.preventDefault(),s.hasErrors())console.log("There are errors in this form"),console.log(s.state.errors);else{console.log("CREATING NEW TODO");var t=s.state.inputs.toDo;s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},{toDo:""})}),s.apiRequestHandler(t),e.target.reset()}},s.state={inputs:{toDo:""},errors:{},requestError:""},s.disable=e.shouldDisable,s}return Object(m.a)(n,[{key:"render",value:function(){return Object(s.jsxs)("form",{onSubmit:this.submitHandler,children:[Object(s.jsx)("span",{className:"ToDoAdd",onClick:null,children:Object(s.jsx)(A.a,{icon:E.e,style:{color:"lightgray"}})})," ",Object(s.jsx)(T,{placeholder:"Add new ToDo ...",styleClass:"InputNewToDo",changeHandler:this.changeHandler,error:this.state.errors.toDo}),Object(s.jsx)(y,{error:""!==this.state.requestError&&this.state.requestError})]})}}]),n}(r.a.Component)),Ce="/milestones",Le={getMilestones:function(e){return x.get(Ce+"?projectId=".concat(e))},getMilestoneById:function(e,t){return x.get("/milestone"+"?projectId=".concat(e,"&milestoneId=").concat(t))},getNextMilestone:function(e){return x.get(Ce+"/next?projectId=".concat(e))},createMilestone:function(e,t){return x.post(Ce+"/post?projectId=".concat(e),t)},deleteMilestone:function(e){return x.delete(Ce+"/delete?milestoneId=".concat(e))}},Ee=function(e){var t=e.projectId,n=Object(a.useState)({}),r=Object(i.a)(n,2),c=r[0],o=r[1],l=Object(a.useState)([]),d=Object(i.a)(l,2),u=d[0],j=d[1],b=Object(a.useState)(!1),m=Object(i.a)(b,2),h=m[0],O=m[1];return Object(a.useEffect)((function(){console.log("GETTING NEXT MILESTONE"),Le.getNextMilestone(t).then((function(e){o(e),console.log("GETTING TODOs"),re.getMyToDos(e.id).then((function(e){console.log(e),j(e)})).catch((function(e){console.log("ERROR: Cannot get myToDos"),console.log(e),j([])}))})).catch((function(e){console.log("ERROR: cannot get the next milestone"),console.log(e),o({}),j([])}))}),[t]),Object(a.useEffect)((function(){h&&c.id&&(console.log("GETTING TODOs"),re.getMyToDos(c.id).then((function(e){console.log(e),j(e)})).catch((function(e){console.log("ERROR: Cannot get myToDos"),console.log(e),j([])})),O(!1))}),[c,h]),Object(s.jsxs)("div",{style:{display:0===Object.keys(c).length?"none":""},children:[Object(s.jsx)("h3",{className:"SidebarSectionTitle",style:{display:"inline-block"},children:"ToDo"}),Object(s.jsxs)("span",{className:"MilestoneDate",children:[" for ",c.dueFor," "]}),u.map((function(e){return Object(s.jsx)(oe,{id:e.id,title:e.title,tagList:e.tags,done:e.done},e.id)})),Object(s.jsx)(De,{milestoneId:c.id,setReloadToDos:O})]})},Ae=function(e){var t=e.id,n=e.color,r=e.title,c=e.reloadCounters,o=e.setReloadCounters,l=Object(a.useState)(0),d=Object(i.a)(l,2),u=d[0],j=d[1];return Object(a.useEffect)((function(){$.getNumberOfNoReadMessagesByTag(t).then((function(e){j(e)})).catch((function(e){console.log("ERROR: cannot get the number of no opened messages")})),o(!1)}),[t,c]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(X,{color:n})," ",Object(s.jsxs)("span",{children:[r," "]})," ",Object(s.jsxs)("span",{style:{float:"right"},children:[" ",u," "]})]})},ke=function(e){var t=e.tagList,n=e.selectedTab,a=e.setSelectedTab,r=e.reloadCounters,c=e.setReloadCounters;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h3",{style:{display:t<=0?"none":"inline-block"},className:"SidebarSectionTitle",children:"Tags"}),t.map((function(e){return Object(s.jsx)(ve,{text:e.id,selectedTab:n,setSelectedTab:a,isTag:!0,children:Object(s.jsx)(Ae,{id:e.id,title:e.title,color:e.color,reloadCounters:r,setReloadCounters:c},e.id)},e.id)}))]})},Pe=function(e){var t=e.numberOfInboxMessages,n=e.numberOfSentMessages,a=e.reloadCounters,r=e.setReloadCounters,c=e.selectedTab,o=e.setSelectedTab,i=e.setModalNewMessage,l=e.modalNewMessage,d=e.pickedProject,u=e.setPickedProject;return Object(s.jsxs)(Me,{children:[Object(s.jsx)(I,{onClick:function(){i(!l)},className:"MainButton",children:"New message"}),Object(s.jsx)("hr",{className:"Separator"}),Object(s.jsx)(Ne,{numberOfInboxMessages:t,numberOfSentMessages:n,selectedTab:c,setSelectedTab:o}),Object(s.jsx)(we,{pickedProject:d,setPickedProject:u}),"Any"!==d.name&&Object(s.jsx)(ke,{tagList:d.tags,selectedTab:c,setSelectedTab:o,reloadCounters:a,setReloadCounters:r}),"Any"!==d.name&&Object(s.jsx)(Ee,{projectId:d.id})]})},ze=(n(32),function(e){return Object(s.jsx)("div",{className:"Section ".concat(e.className),children:e.children})}),Re=function(e){var t=e.search,n=e.setSearch,r=Object(a.useState)("Inbox"),c=Object(i.a)(r,2),o=c[0],l=c[1],d=Object(a.useState)([]),u=Object(i.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)([]),h=Object(i.a)(m,2),O=h[0],g=h[1],p=Object(a.useState)({name:"Any",id:9999,tags:[]}),f=Object(i.a)(p,2),x=f[0],M=f[1],v=Object(a.useState)(!0),N=Object(i.a)(v,2),T=N[0],y=N[1];Object(a.useEffect)((function(){T&&$.getNumberOfNotReadMessages().then((function(e){g(e)})).catch((function(e){console.log("ERROR: cannot get number of inbox messages")})),y(!1)}),[T]),Object(a.useEffect)((function(){if(""!==t)console.log("Searching messages by keywords: "+t),l("Search"),$.getMyMessagesBySearch(t).then((function(e){console.log("Getting searched Messages"),b(e)})).catch((function(e){console.log("ERROR: cannot get the searched messages")})),n("");else switch(o){case"Inbox":$.getMyInboxMessages().then((function(e){console.log("Getting inbox Messages"),b(e)})).catch((function(e){console.log("ERROR: cannot get inbox messages")}));break;case"Sent":$.getMySentMessages().then((function(e){console.log("Getting sent Messages"),b(e)})).catch((function(e){console.log("ERROR: cannot get sent messages")}));break;default:$.getMyMessagesByTag(o).then((function(e){console.log("Getting Tag Messages"),b(e)})).catch((function(e){console.log("ERROR: cannot get tag messages")}))}}),[o,t,T]);var I=Object(a.useState)(!1),S=Object(i.a)(I,2),w=S[0],D=S[1];return Object(s.jsxs)("div",{className:"Content",children:[Object(s.jsx)(Pe,{numberOfInboxMessages:O,numberOfSentMessages:"",reloadCounters:T,setReloadCounters:y,selectedTab:o,setSelectedTab:l,modalNewMessage:w,setModalNewMessage:D,pickedProject:x,setPickedProject:M}),Object(s.jsxs)(ze,{className:"Section--Lighter",children:[w&&Object(s.jsx)(xe,{ChangeModalNewMessage:function(){return D(!w)}}),Object(s.jsx)(ue,{setReloadCounters:y,messages:j})]})]})},He=Object(d.h)((function(e){var t=e.text,n=e.path,a=e.history,r=(e.to,"SidebarTab");return Object(d.g)().pathname===n&&(r+=" SidebarTab--Selected"),Object(s.jsx)("div",{className:r,onClick:function(){return a.push(n)},children:t})})),Ue=(n(104),function(){var e=Object(a.useContext)(V);return void 0===e.isTeamManager?Object(s.jsx)(Me,{}):Object(s.jsxs)(Me,{children:[e.isTeamManager?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(P,{gradient:!0,className:"MainButton",path:"/settings/users",children:"Add a new user"}),Object(s.jsx)("hr",{className:"Separator"})]}):"",Object(s.jsx)("h3",{className:"SettingSidebarTitle",children:"Team Settings"}),e.isTeamManager?Object(s.jsx)(He,{text:"Team",path:"/settings/team"}):"",Object(s.jsx)(He,{text:"Departments",path:"/settings/departments"}),Object(s.jsx)(He,{text:"Projects",path:"/settings/projects"}),Object(s.jsx)(He,{text:"Users",path:"/settings/users"})]})}),Be=(n(19),function(e){var t=e.src,n=e.role,a=e.name,r=e.slim,c=e.children;return r?Object(s.jsxs)("div",{className:"ProfileHeader ProfileHeader--Slim",children:[c,Object(s.jsx)(G,{src:t,className:"ProfilePic--Slim"}),Object(s.jsxs)("div",{className:"ProfileTitleContainer",children:[Object(s.jsx)("h3",{className:"TinyTitle",children:n}),Object(s.jsx)("h1",{className:"BigTitle BigTitle--Slim",children:a})]})]}):Object(s.jsxs)("div",{className:"ProfileHeader",children:[Object(s.jsx)(G,{src:t}),Object(s.jsxs)("div",{className:"ProfileTitleContainer",children:[Object(s.jsx)("h3",{className:"TinyTitle",children:n}),Object(s.jsx)("h1",{className:"BigTitle",children:a})]})]})}),Fe="/team",Ge={getTeamName:function(){return x.get(Fe)},updateTeam:function(e){return x.post("/team/update",e)},deleteTeam:function(){return x.delete("/team/delete")}},Ze=(n(105),function(e){var t=e.value,n=e.inputType,r=e.smaller,c=e.editable,o=e.postFunction,l=e.fieldName,d=e.onUpdated;function u(){if(o&&l&&x!==T){if(!T)return y(x),void g(!1);var e={};e[l]=T,o(e).catch((function(){H(!0),M(x),y(x),d&&d(l,x),setTimeout((function(){return H(!1)}),5e3)})),M(x),g(!1),d&&d(l,T)}else g(!1)}var j,b,m=Object(a.useState)(!1),h=Object(i.a)(m,2),O=h[0],g=h[1],p=Object(a.useState)(t),f=Object(i.a)(p,2),x=f[0],M=f[1],v=Object(a.useState)(t),N=Object(i.a)(v,2),T=N[0],y=N[1],S=Object(a.useState)(!Boolean(t)),w=Object(i.a)(S,2),D=w[0],C=w[1],L=Object(a.useState)(!1),E=Object(i.a)(L,2),A=E[0],k=E[1],P=Object(a.useState)(null),z=Object(i.a)(P,2),R=z[0],H=z[1];return Object(a.useEffect)((function(){O&&j.focus()}),[O,j]),Object(a.useEffect)((function(){t&&(y(t),M(t),C(!1))}),[t]),O?Object(s.jsxs)("div",{className:"EditableField EditableField--Editing ".concat(r?"EditableField--Smaller":""),children:[Object(s.jsx)("input",{className:"Input EditingInput EditingInput--MinusButton",type:null!==n&&void 0!==n?n:"text",defaultValue:T,onChange:function(e){return y(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&u()},ref:function(e){return j=e}}),Object(s.jsx)(I,{className:"EditingOkButton",onClick:function(){return u()},children:"OK"})]}):(!1!==c&&(b=Object(s.jsx)("i",{className:"fas fa-pen PenIcon"})),Object(s.jsxs)("div",{className:"EditableField ".concat(r?"EditableField--Smaller":""),onClick:function(){!1!==c?g(!0):(k(!0),navigator.clipboard.writeText(T),setTimeout((function(){return k(!1)}),1e3))},children:[Object(s.jsx)("h3",{className:"BoldTitle ".concat(r?"BoldTitle--Smaller":""," ").concat(D?"LoadingPlaceholder":""),children:T}),b,A?Object(s.jsx)("span",{className:"CopiedSpan",children:"Copied"}):"",R?Object(s.jsx)("span",{className:"CopiedSpan CopiedSpan--Error",children:"Something went wrong updating the value. Try again?"}):""]}))}),Ye=(n(106),function(e){var t,n;return t=e.danger?Object(s.jsxs)("h3",{className:"SmallTitle",children:[Object(s.jsx)("span",{className:"DangerTitle",children:"DANGER ZONE"})," \u2013 ",e.name]}):Object(s.jsx)("h3",{className:"SmallTitle",children:e.name}),e.description&&(n=Object(s.jsx)("p",{className:"SettingGroup__P",dangerouslySetInnerHTML:{__html:e.description}})),Object(s.jsxs)("div",{className:"EditableSettingGroup",children:[t,n,e.children]})}),qe=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Ge.getTeamName().then((function(e){return r(e)}))}),[]),Object(s.jsxs)("div",{className:"SettingGroupsContainer",children:[Object(s.jsx)(Ye,{name:"Team name",description:"Shown in messages sent by team members.",children:Object(s.jsx)(Ze,{value:n,postFunction:Ge.updateTeam,fieldName:"name"})}),Object(s.jsx)(Ye,{danger:!0,name:"Delete team",description:"Deletes the team, as well as its associated members, departments, projects and tasks. <br>This action cannot be undone.",children:Object(s.jsx)(k,{className:"Button--red",onClick:function(){window.confirm("Are you sure to delete this team and associated data? This action cannot be undone and you will be signed out.")&&Ge.deleteTeam().then((function(){return window.location.replace("/")}))},children:"Delete team"})})]})},Je=(n(22),function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s;return Object(b.a)(this,n),(s=t.call(this,e)).hasErrors=function(){var e=Object.values(s.state.errors),t=Object.keys(s.state.inputs).length;return e.length<t||e.some((function(e){return""!==e}))},s.validateAll=function(){Object.entries(s.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];s.validate(n,a)}))},s.validate=function(e,t){s.setState({requestError:""});var n="";switch(e){case"name":""===t?n="First name required":/^[a-zA-Z\xc0-\xff\u00f1\u00d1 ]+$/.test(t)||(n="Invalid, use letters and numbers");break;case"lastname":""===t?n="Last name required":/^[a-zA-Z\xc0-\xff\u00f1\u00d1 ]+$/.test(t)||(n="Invalid, use letters and numbers");break;case"password":""===t?n="Password required":t.length<8&&(n="Passwords at least 8 characters")}s.setState({errors:Object(j.a)(Object(j.a)({},s.state.errors),{},Object(u.a)({},e,n))})},s.changeHandler=function(e,t){s.validate(e,t),s.setState({inputs:Object(j.a)(Object(j.a)({},s.state.inputs),{},Object(u.a)({},e,t))})},s.apiRequestHandler=function(e,t,n){s.setState({isSubmitting:!0}),W.registerUser({name:e,lastname:t,password:n}).then((function(){s.setState({inputs:{},errors:{},requestError:"",isSubmitting:!1}),s.onUserRegistered()})).catch((function(e){console.log("API ERROR!");var t="Something went wrong.";"alreadyexists"===(e=e.response.data)?t="An user with that name already exists.":"errors"===e&&(t="Check your inputs and try again."),s.setState({requestError:t,isSubmitting:!1})}))},s.submitHandler=function(e){if(e.preventDefault(),s.validateAll(),s.hasErrors())console.log("There are errors in this form"),console.log(s.state.errors);else{var t=s.state.inputs.name,n=s.state.inputs.lastname,a=s.state.inputs.password;s.apiRequestHandler(t,n,a)}},s.state={inputs:{name:"",lastname:"",password:""},errors:{},requestError:"",isSubmitting:!1},s.onUserRegistered=e.onUserRegistered,s}return Object(m.a)(n,[{key:"render",value:function(){var e,t,n;return Object(s.jsxs)("form",{onSubmit:this.submitHandler,autoComplete:"off",children:[Object(s.jsx)("p",{className:"InputTitle",children:"First Name"}),Object(s.jsx)("div",{className:"EditableField EditableField--OnlyInput",children:Object(s.jsx)(T,{name:"name",styleClass:"Input EditingInput",placeholder:"Johnny",error:this.state.errors.name,changeHandler:this.changeHandler,value:null!==(e=this.state.inputs.name)&&void 0!==e?e:""})}),Object(s.jsx)("p",{className:"InputTitle",children:"Last Name"}),Object(s.jsx)("div",{className:"EditableField EditableField--OnlyInput",children:Object(s.jsx)(T,{name:"lastname",styleClass:"Input EditingInput",placeholder:"Depp",error:this.state.errors.lastname,changeHandler:this.changeHandler,value:null!==(t=this.state.inputs.lastname)&&void 0!==t?t:""})}),Object(s.jsx)("p",{className:"InputTitle",children:"Password"}),Object(s.jsx)("div",{className:"EditableField EditableField--OnlyInput",children:Object(s.jsx)(T,{name:"password",type:"password",styleClass:"Input EditingInput",placeholder:"More than 8 characters",error:this.state.errors.password,changeHandler:this.changeHandler,value:null!==(n=this.state.inputs.password)&&void 0!==n?n:""})}),Object(s.jsx)(w,{reducedsize:!0,text:"Add user",requestError:this.state.requestError,hasErrors:this.hasErrors(),loading:this.state.isSubmitting})]})}}]),n}(r.a.Component)),Qe=(n(24),function(e){var t,n=e.members;return n?(n&&n.length>0&&(t=n.map((function(e){var t=(e.name+" "+e.lastname).toLowerCase().replace(/ /g,"");return Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsxs)(l.b,{to:"/settings/users/".concat(e.id,"/").concat(t),children:[e.lastname,", ",e.name]})}),Object(s.jsx)("td",{children:e.email}),Object(s.jsx)("td",{children:"team_owner"===e.role?"Team manager":"Member"}),Object(s.jsx)("td",{children:e.joinDate})]},e.id)}))),Object(s.jsxs)("table",{className:"UserList",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"E-mail address"}),Object(s.jsx)("th",{children:"Role"}),Object(s.jsx)("th",{children:"Member since"})]})}),Object(s.jsx)("tbody",{children:t})]})):Object(s.jsx)(S,{})}),We=function(){var e=Object(a.useContext)(V),t=Object(a.useState)(null),n=Object(i.a)(t,2),r=n[0],c=n[1];function o(){W.getUsers().then((function(e){return c(e.sort((function(e,t){return(e.lastname+e.name).localeCompare(t.lastname+t.name)})))})).catch((function(e){return console.error(e)}))}return console.log(e),Object(a.useEffect)((function(){return o()}),[]),Object(s.jsxs)("div",{className:"SettingGroupsContainer",children:[e.isTeamManager?Object(s.jsx)(Ye,{name:"Add a new user",description:"Fill out the form fields below.",children:Object(s.jsx)(Je,{onUserRegistered:o})}):"",Object(s.jsx)(Ye,{name:"Users",description:"Registered team users are shown below.",children:Object(s.jsx)(Qe,{members:r})})]})},Ve=n(58),_e=n.n(Ve),Ke=(n(117),function(e){var t=e.name,n=e.placeholder,r=e.departmentId,c=e.projectId,o=e.onUserSelected,l=e.val,d=e.onChangeHandler;function u(e){return e.name+" "+e.lastname}function j(e,t){return e.name>t.name?1:e.name<t.name||e.lastname<t.lastname?-1:e.lastname>t.lastname?1:0}var b=Object(a.useState)(null),m=Object(i.a)(b,2),h=m[0],O=m[1],g=Object(a.useState)(-1),p=Object(i.a)(g,2),f=p[0],x=p[1],M=Object(a.useState)([]),v=Object(i.a)(M,2),N=v[0],T=v[1];Object(a.useEffect)((function(){c?Se.getMembersFromProject(c).then((function(e){var t=e.map((function(e){return e.id=e.userId,e})).sort(j);O(t)})).catch((function(e){return console.error(e)})):r?ye.getMembersFromDepartment(r).then((function(e){var t=e.map((function(e){return e.id=e.userId,e})).sort(j);O(t)})).catch((function(e){return console.error(e)})):W.getUsers().then((function(e){return O(e)})).catch((function(e){return console.error(e)}))}),[]);var y=!1;h&&0===h.length&&(y=c?"No users in this project.":r?"No users in this department.":"No users found.");var I={name:t,placeholder:y||(h?n:"Loading users..."),value:l,onChange:function(e,n){var s=n.newValue;d(t,s),-1!==f&&(x(-1),o&&o(t,s,-1))},onBlur:function(){-1===f&&d(t,"")},disabled:Boolean(y)||!h,className:"Input EditingInput"};return Object(s.jsx)("div",{className:"EditableField EditableField--OnlyInput",children:Object(s.jsx)(_e.a,{suggestions:N,onSuggestionsFetchRequested:function(e){var t=e.value;T(function(e){var t=e.trim().toLowerCase(),n=t.length;return 0===n?[]:h.filter((function(e){return(e.name+" "+e.lastname).toLowerCase().slice(0,n)===t}))}(t))},onSuggestionsClearRequested:function(){T([])},onSuggestionSelected:function(e,n){var s=n.suggestion;o&&o(t,u(s),s.id),x(s.id)},getSuggestionValue:u,renderSuggestion:function(e){return Object(s.jsxs)("div",{children:[e.name," ",e.lastname]})},theme:{container:"SuggestionsContainer",suggestionsList:"SuggestionsList",suggestion:"Suggestion",suggestionHighlighted:"Suggestion--Highlighted",suggestionsContainer:"SuggestionsListBox"},inputProps:I})})}),$e=function(e){Object(h.a)(n,e);var t=Object(O.a)(n);function n(e){var s,a,r,c,o;return Object(b.a)(this,n),(o=t.call(this,e)).hasErrors=function(){return!!Object.values(o.state.inputs).some((function(e){return!e}))||Object.values(o.state.errors).some((function(e){return""!==e}))},o.validateAll=function(){Object.entries(o.state.inputs).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],s=t[1];o.validate(n,s)}))},o.validate=function(e,t){if(o.setState({requestError:""}),!(o.validateExcludeFields.indexOf(e)>=0)){var n="";""===t?n="You can't leave this field empty":/^[a-zA-Z\xc0-\xff\u00f1\u00d1 0-9]+$/.test(t)||(n="Invalid, use letters and numbers"),o.setState({errors:Object(j.a)(Object(j.a)({},o.state.errors),{},Object(u.a)({},e,n))})}},o.changeHandler=function(e,t){o.validate(e,t),o.setState({inputs:Object(j.a)(Object(j.a)({},o.state.inputs),{},Object(u.a)({},e,t))})},o.apiRequestHandler=function(e){o.postFunction?(o.setState({isSubmitting:!0}),o.postFunction(e).then((function(){o.setState({inputs:{},errors:{},requestError:"",isSubmitting:!1})})).catch((function(e){var t;console.error(e),t="alreadyexists"===e.response.data||"toomany"===e.response.data?"toomany"===e.response.data?o.tooManyErrorText:o.alreadyExistsErrorText:"Something went wrong",o.setState({requestError:t,isSubmitting:!1})}))):o.setState({inputs:{},errors:{},requestError:""})},o.submitHandler=function(e){if(e.preventDefault(),o.validateAll(),o.hasErrors())console.log("There are errors in this form"),console.log(o.state.errors);else{var t=o.state.inputs;o.apiRequestHandler(t)}},o.onAutocomplete=function(e,t,n){o.setState({autocompleteVal:n,inputs:Object(j.a)(Object(j.a)({},o.state.inputs),{},Object(u.a)({},e,t))}),o.onAutocompleteSelected&&o.onAutocompleteSelected(e,n)},o.state={inputs:{},errors:{},requestError:"",children:[],isSubmitting:!1,autocompleteVal:null},o.submitText=null!==(s=e.submitText)&&void 0!==s?s:"Add element",o.postFunction=e.postFunction,o.children=e.children,o.alreadyExistsErrorText=null!==(a=e.alreadyExistsErrorText)&&void 0!==a?a:"An element with the same name already exists.",o.tooManyErrorText=null!==(r=e.tooManyErrorText)&&void 0!==r?r:"The maximum number of elements has been reached.",o.disabled=e.disabled,o.onAutocompleteSelected=e.onAutocompleteSelected,o.validateExcludeFields=null!==(c=e.validateExcludeFields)&&void 0!==c?c:[],o}return Object(m.a)(n,[{key:"processChildren",value:function(){var e=this,t={},n=r.a.Children.map(this.children,(function(n){if(r.a.isValidElement(n)){if(n.type===T){var a,c,o,i=n.props.name,l=n.props.placeholder,d=n.props.type;return t[i]=null!==(a=e.state.inputs[i])&&void 0!==a?a:"",Object(s.jsx)("div",{className:"EditableField EditableField--OnlyInput",children:Object(s.jsx)(T,{name:i,type:d,styleClass:"Input EditingInput",placeholder:l,value:null!==(c=e.state.inputs[i])&&void 0!==c?c:"",error:null!==(o=e.state.errors[i])&&void 0!==o?o:"",changeHandler:e.changeHandler})})}if(n.type===Ke){var u,j,b=n.props.name;return t[b]=null!==(u=e.state.inputs[b])&&void 0!==u?u:"",e.state.autocompleteVal||e.setState({autocompleteVal:-1}),r.a.cloneElement(n,{onUserSelected:e.onAutocomplete,onChangeHandler:e.changeHandler,val:null!==(j=e.state.inputs[b])&&void 0!==j?j:""})}}return n}));this.setState({inputs:t}),this.setState({children:n})}},{key:"componentDidMount",value:function(){this.processChildren()}},{key:"componentDidUpdate",value:function(e,t){JSON.stringify(this.state.inputs)!==JSON.stringify(t.inputs)&&this.processChildren()}},{key:"render",value:function(){return Object(s.jsxs)("form",{onSubmit:this.submitHandler,children:[this.state.children,Object(s.jsx)(w,{reducedsize:!0,text:this.submitText,requestError:this.state.requestError,hasErrors:this.disabled||this.hasErrors()||this.state.autocompleteVal&&-1===this.state.autocompleteVal,loading:this.state.isSubmitting})]})}}]),n}(r.a.Component),Xe=function(e){var t=e.onDepartmentAdded;return Object(s.jsxs)($e,{submitText:"Add department",postFunction:function(e){return new Promise((function(n,s){ye.postDepartment(e).then((function(){n(),t&&t()})).catch((function(e){return s(e)}))}))},alreadyExistsErrorText:"There's already a department with that name.",children:[Object(s.jsx)("p",{className:"InputTitle",children:"Name"}),Object(s.jsx)(T,{name:"name",placeholder:"Software Dpt"}),Object(s.jsx)("p",{className:"InputTitle",children:"Description"}),Object(s.jsx)(T,{name:"description",placeholder:"A brief description"})]})},et=function(e){var t=e.onUserAdded,n=e.submitText,r=e.departmentId;var c=Object(a.useRef)(-1);return Object(s.jsxs)($e,{hasAutocomplete:!0,submitText:n,postFunction:function(){return new Promise((function(e,n){ye.addUserToDepartment(r,c.current).then((function(){e(),t&&t()})).catch((function(e){return n(e)}))}))},alreadyExistsErrorText:"That user is already a member in this department.",onAutocompleteSelected:function(e,t){c.current=t},children:[Object(s.jsx)("p",{className:"InputTitle",children:"Full Name"}),Object(s.jsx)(Ke,{name:"name",placeholder:"Harvey Specter"},c)]})},tt=(n(34),function(e){var t=e.children,n=e.selected,a=e.highlighted,r=e.elementDiv,c=e.reducedpadding,o=e.onClick,i="SidePaneElement ";return n&&(i+="SidePaneElement--Selected"),a&&(i+="SidePaneElement--Highlighted"),c&&(i+="SidePaneElement--ReducedPadding"),r?Object(s.jsx)("div",{className:i,onClick:o,children:t}):Object(s.jsx)("p",{className:i,onClick:o,children:t})}),nt=function(e){var t,n,r=e.departmentId,c=e.members,o=e.loading,i=e.onListUpdated,d=Object(a.useContext)(V),u=d.isDepartmentManager(r);return o?Object(s.jsx)(S,{}):c&&c.length>0?(t=c.map((function(e){var t=(e.name+" "+e.lastname).toLowerCase().replace(/ /g,"");return u?Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsxs)(l.b,{to:"/settings/users/".concat(e.userId,"/").concat(t),children:[e.lastname,", ",e.name]})}),Object(s.jsx)("td",{children:e.email}),Object(s.jsx)("td",{children:e.isDepartmentManager?"Dpt. Manager":"Member"}),Object(s.jsx)("td",{children:e.initialDate}),Object(s.jsxs)("td",{className:"ActionStrip",children:[Object(s.jsx)("span",{onClick:function(){return function(e){var t=!d.isTeamManager&&u;if(e.isDepartmentManager){var n="Are you sure to demote ".concat(e.name," ").concat(e.lastname," and make them a member?");t&&(n="NOTE: You are demoting yourself and you will NO LONGER HAVE MANAGEMENT PRIVILEGES. This action cannot be undone. Would you like to continue?"),window.confirm(n)&&ye.addUserToDepartment(r,e.userId,!1).then((function(){t?window.location.replace("/settings/departments"):i()})).catch((function(e){return console.error(e)}))}else{var s="Are you sure to demote ".concat(e.name," ").concat(e.lastname," and make them a member?");t&&(s="NOTE: You are promoting ".concat(e.name," ").concat(e.lastname," to department manager. You will NO LONGER HAVE MANAGEMENT PRIVILEGES. This action cannot be undone. Would you like to continue?")),window.confirm(s)&&ye.addUserToDepartment(r,e.userId,!0).then((function(){t?window.location.replace("/settings/departments"):i()})).catch((function(e){return console.error(e)}))}}(e)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:e.isDepartmentManager?"Demote":"Promote"}),Object(s.jsx)("span",{onClick:function(){return function(e){var t=e.userId===d.user.id&&!d.isTeamManager&&u,n="Are you sure to remove ".concat(e.name," ").concat(e.lastname," from the department?");t&&(n="Are you sure to REMOVE YOURSELF from this department and lose access? This action cannot be undone."),window.confirm(n)&&ye.removeUserFromDepartment(r,e.userId).then((function(){t?window.location.reload():i()})).catch((function(e){return console.error(e)}))}(e)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:"Remove"})]})]},e.id):Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsxs)(l.b,{to:"/settings/users/".concat(e.userId,"/").concat(t),children:[e.lastname,", ",e.name]})}),Object(s.jsx)("td",{children:e.email}),Object(s.jsx)("td",{children:e.isDepartmentManager?"Dpt. Manager":"Member"}),Object(s.jsx)("td",{children:e.initialDate})]},e.id)})),n=u?Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"E-mail address"}),Object(s.jsx)("th",{children:"Role"}),Object(s.jsx)("th",{children:"Member since"}),Object(s.jsx)("th",{children:"Actions"})]}):Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"E-mail address"}),Object(s.jsx)("th",{children:"Role"}),Object(s.jsx)("th",{children:"Member since"})]}),Object(s.jsxs)("table",{className:"UserList",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:n}),Object(s.jsx)("tbody",{children:t})]})):Object(s.jsx)("p",{children:"This department has no members yet."})},st=n(20),at=n.n(st),rt=function(e){var t=e.departments,n=e.onDepartmentDeleted,r=Object(a.useContext)(V);function c(e,t){t!==p[m][e]&&f(Object.values(Object(j.a)(Object(j.a)({},p),{},Object(u.a)({},m,Object(j.a)(Object(j.a)({},p[m]),{},Object(u.a)({},e,t))))))}function o(e){return e.id=p[m].id,ye.updateDepartment(e)}function l(){null!=I&&w(null),ye.getMembersFromDepartment(p[m].id).then((function(e){return w(e)})).catch((function(e){return console.error(e)}))}var d=Object(a.useState)(0),b=Object(i.a)(d,2),m=b[0],h=b[1],O=Object(a.useState)(t),g=Object(i.a)(O,2),p=g[0],f=g[1],x=Object(a.useState)(!1),M=Object(i.a)(x,2),v=M[0],N=M[1],T=Object(a.useState)(null),y=Object(i.a)(T,2),I=y[0],w=y[1];if(Object(a.useEffect)((function(){return l()}),[m,p]),p.length!==t.length&&f(t),!p)return Object(s.jsx)("p",{children:"No departments found."});if(!(m>=p.length)){for(var D=[],C=function(e){var t=p[e];D.push(Object(s.jsx)(tt,{selected:e===m,onClick:function(){return h(e)},children:t.name},e))},L=0;L<p.length;L++)C(L);var E,A,P=p[m],z=r.isDepartmentManager(P.id);return z&&(E=Object(s.jsx)(Ye,{name:"Add user to department",description:"Start typing their name below.",children:Object(s.jsx)(et,{onUserAdded:function(){l()},departmentId:P.id,submitText:"Add to ".concat(P.name)},P.name)}),A=Object(s.jsx)(Ye,{danger:!0,name:"Delete department",description:"Deletes the department, as well as its associated members and projects. <br>This action cannot be undone.",children:Object(s.jsx)(k,{className:"Button--red",onClick:function(){window.confirm("Are you sure to delete this department and associated data? This action cannot be undone.")&&(N(!0),ye.deleteDepartment(p[m].id).then((function(){N(!1),n&&n()})).catch((function(e){N(!1),console.error(e)})))},children:v?Object(s.jsx)(S,{red:!0}):"Delete department"})})),Object(s.jsxs)("div",{className:"SubsettingContainer",children:[Object(s.jsx)("div",{className:"SubsettingSidePane",children:Object(s.jsx)(at.a,{boundaryElement:".SubsettingSidePane",topOffset:-240,stickyStyle:{transform:"translateY(240px)"},children:D})}),Object(s.jsxs)("div",{className:"SettingGroupsContainer",children:[Object(s.jsx)(Ye,{name:"Department name",description:"Shown in projects assigned to team members.",children:Object(s.jsx)(Ze,{value:P.name,fieldName:"name",editable:z,postFunction:o,onUpdated:c},m)}),Object(s.jsx)(Ye,{name:"Description",description:"A brief description for the responsibilities of the department.",children:Object(s.jsx)(Ze,{smaller:!0,value:P.description,editable:z,fieldName:"description",postFunction:o,onUpdated:c},m)}),E,Object(s.jsx)(Ye,{name:"Members",description:z?"Click on a user to see their profile and hover to show available actions.":"Click on a user to see their profile.",children:Object(s.jsx)(nt,{departmentId:P.id,loading:null==I,members:I,onListUpdated:l},m)}),A]})]})}h(m-1)},ct=function(){var e=Object(a.useContext)(V);function t(){(e.isTeamManager?ye.getDepartments:ye.getMyDepartments)().then((function(e){return d(e.sort((function(e,t){return e.name.localeCompare(t.name)})))})).catch((function(e){return console.error(e)}))}var n,r,c=Object(a.useState)(null),o=Object(i.a)(c,2),l=o[0],d=o[1];return Object(a.useEffect)((function(){t()}),[]),n=l?l.length>0?Object(s.jsx)(Ye,{name:"Manage departments",description:" ",children:Object(s.jsx)(rt,{departments:l,onDepartmentDeleted:t})}):Object(s.jsx)(Ye,{name:"Manage departments",description:e.isTeamManager?"There aren't any departments yet.":"You aren't a member of any departments."}):Object(s.jsx)(Ye,{name:"Manage departments",description:" ",children:Object(s.jsx)(S,{})}),e.isTeamManager&&(r=Object(s.jsx)(Ye,{name:"Create new department",description:"You will be able to add users once created.",children:Object(s.jsx)(Xe,{onDepartmentAdded:t})})),Object(s.jsxs)("div",{className:"SettingGroupsContainer",children:[r,n]})},ot=function(e){var t=e.projectId,n=e.onMilestoneAdded;return Object(s.jsxs)($e,{submitText:"Add milestone",postFunction:function(e){return new Promise((function(s,a){Le.createMilestone(t,e).then((function(){s(),n&&n()})).catch((function(e){return a(e)}))}))},validateExcludeFields:["dueFor"],children:[Object(s.jsx)("p",{className:"InputTitle",children:"Name"}),Object(s.jsx)(T,{name:"name",placeholder:"Sprint Feb 20"}),Object(s.jsx)("p",{className:"InputTitle",children:"Due by"}),Object(s.jsx)(T,{name:"dueFor",type:"date"})]})},it=function(e){var t=e.projectId,n=e.onTagAdded;function a(e,t,n){n/=100;var s=t*Math.min(n,1-n)/100,a=function(t){var a=(t+e/30)%12,r=n-s*Math.max(Math.min(a-3,9-a,1),-1);return Math.round(255*r).toString(16).padStart(2,"0")};return"#".concat(a(0)).concat(a(8)).concat(a(4))}return Object(s.jsxs)($e,{submitText:"Add tag",postFunction:function(e){var s={title:e.title,color:a(360*Math.random(),100,50)};return new Promise((function(e,a){be.addNewTag(t,s).then((function(){e(),n&&n()})).catch((function(e){return a(e)}))}))},alreadyExistsErrorText:"A tag with that name already exists in this project.",tooManyErrorText:"There can only be a maximum of 6 tags per project.",children:[Object(s.jsx)("p",{className:"InputTitle",children:"Tag"}),Object(s.jsx)(T,{name:"title",placeholder:"Development"})]})},lt=function(e){var t=e.onUserAdded,n=e.submitText,r=e.projectId,c=e.departmentId;var o=Object(a.useRef)(-1);return Object(s.jsxs)($e,{hasAutocomplete:!0,submitText:n,postFunction:function(){return new Promise((function(e,n){Se.addUserToProject(r,o.current).then((function(){e(),t&&t()})).catch((function(e){return n(e)}))}))},alreadyExistsErrorText:"That user is already a project member.",onAutocompleteSelected:function(e,t){o.current=t},children:[Object(s.jsx)("p",{className:"InputTitle",children:"Full Name"}),Object(s.jsx)(Ke,{departmentId:c,name:"name",placeholder:"Harvey Specter"},o)]})},dt=function(e){var t,n=e.departmentId,r=e.projectName,c=e.projectId,o=e.updateCounter,d=Object(a.useState)(null),u=Object(i.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(!0),h=Object(i.a)(m,2),O=h[0],g=h[1];if(Object(a.useEffect)((function(){Le.getMilestones(c).then((function(e){b(e),g(!1)})).catch((function(e){return console.error(e)}))}),[c,o]),O)return Object(s.jsx)(S,{});if(!(j&&j.length>0))return Object(s.jsx)("p",{children:"This project has no milestones yet."});var p=new Date;return t=j.map((function(e){var t=e.name.replace(/ /g,"-"),a=r.replace(/ /g,"-"),o=new Date(e.dueFor)<p?"Expired:":"";return Object(s.jsxs)("tr",{children:[Object(s.jsxs)("td",{children:[Object(s.jsx)("i",{children:o})," ",Object(s.jsx)(l.b,{to:"/settings/projects/".concat(n,"/").concat(a,"/").concat(c,"/").concat(t,"/").concat(e.id),children:e.name})]}),Object(s.jsx)("td",{children:e.toDos.length}),Object(s.jsx)("td",{children:e.dueFor})]},e.id)})),Object(s.jsxs)("table",{className:"UserList UserList--Smaller",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"Tasks"}),Object(s.jsx)("th",{children:"Due by"})]})}),Object(s.jsx)("tbody",{children:t})]})},ut=function(e){var t,n,r=e.departmentId,c=e.projectId,o=e.members,i=e.loading,d=e.onListUpdated,u=Object(a.useContext)(V),j=u.isProjectManager(c,r);return i?Object(s.jsx)(S,{}):o&&o.length>0?(t=o.map((function(e){var t,n=(e.name+" "+e.lastname).toLowerCase().replace(/ /g,"");return j&&(t=Object(s.jsxs)("td",{className:"ActionStrip",children:[Object(s.jsx)("span",{onClick:function(){return function(e){var t=!u.isTeamManager&&!u.isDepartmentManager(r)&&j;if(e.isProjectManager){var n="Are you sure to demote ".concat(e.name," ").concat(e.lastname," and make them a member?");t&&(n="NOTE: You are demoting yourself and you will NO LONGER HAVE MANAGEMENT PRIVILEGES. This action cannot be undone. Would you like to continue?"),window.confirm(n)&&Se.addUserToProject(c,e.userId,!1).then((function(){t?window.location.reload():d()})).catch((function(e){return console.error(e)}))}else{var s="Are you sure to promote ".concat(e.name," ").concat(e.lastname," to project manager?");t&&(s="NOTE: You are promoting ".concat(e.name," ").concat(e.lastname," to project manager. You will NO LONGER HAVE MANAGEMENT PRIVILEGES. This action cannot be undone. Would you like to continue?")),window.confirm(s)&&Se.addUserToProject(c,e.userId,!0).then((function(){t?window.location.reload():d()})).catch((function(e){return console.error(e)}))}}(e)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:e.isProjectManager?"Demote":"Promote"}),Object(s.jsx)("span",{onClick:function(){return function(e){var t=e.userId===u.user.id&&!u.isTeamManager&&!u.isDepartmentManager(r)&&j,n="Are you sure to remove ".concat(e.name," ").concat(e.lastname," from the project?");t&&(n="Are you sure to REMOVE YOURSELF from this project and lose access? This action cannot be undone."),window.confirm(n)&&Se.removeUserFromProject(c,e.userId).then((function(){t?window.location.reload():d()})).catch((function(e){return console.error(e)}))}(e)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:"Remove"})]})),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:Object(s.jsxs)(l.b,{to:"/settings/users/".concat(e.userId,"/").concat(n),children:[e.lastname,", ",e.name]})}),Object(s.jsx)("td",{children:e.email}),Object(s.jsx)("td",{children:e.isProjectManager?"Proj. Manager":"Member"}),Object(s.jsx)("td",{children:e.initialDate}),t]},e.id)})),j&&(n=Object(s.jsx)("th",{children:"Actions"})),Object(s.jsxs)("table",{className:"UserList",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"E-mail address"}),Object(s.jsx)("th",{children:"Role"}),Object(s.jsx)("th",{children:"Member since"}),n]})}),Object(s.jsx)("tbody",{children:t})]})):Object(s.jsx)("p",{children:"This project has no members yet."})},jt=function(e){var t,n=e.departmentId,r=e.projectId,c=e.updateCounter,o=Object(a.useContext)(V).isProjectManager(r,n),l=Object(a.useState)(null),d=Object(i.a)(l,2),u=d[0],j=d[1],b=Object(a.useState)(!0),m=Object(i.a)(b,2),h=m[0],O=m[1];function g(){be.getTags(r).then((function(e){j(e),O(!1)})).catch((function(e){return console.error(e)}))}return Object(a.useEffect)((function(){g()}),[r,c]),h?Object(s.jsx)(S,{}):u&&u.length>0?(t=u.map((function(e){return Object(s.jsxs)("tr",{children:[Object(s.jsxs)("td",{children:[Object(s.jsx)(X,{color:e.color}),"  ",e.title]}),Object(s.jsx)("td",{children:e.todosUsingTag}),o?Object(s.jsx)("td",{className:"ActionStrip",children:Object(s.jsx)("span",{onClick:function(){return function(e){window.confirm('Are you sure to remove tag "'.concat(e.title,'" from the project?'))&&be.deleteTag(r,e.id).then((function(){return g()})).catch((function(e){return console.error(e)}))}(e)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:"Remove"})}):void 0]},e.id)})),Object(s.jsxs)("table",{className:"UserList UserList--Smaller",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"Tasks"}),o?Object(s.jsx)("th",{children:"Actions"}):void 0]})}),Object(s.jsx)("tbody",{children:t})]})):Object(s.jsx)("p",{children:"This project has no tags yet."})},bt=function(e){var t=e.departments,n=e.onProjectAdded,r=e.onProjectDeleted,c=Object(a.useContext)(V),o=Object(a.useState)(0),l=Object(i.a)(o,2),d=l[0],u=l[1],b=Object(a.useState)(0),m=Object(i.a)(b,2),h=m[0],O=m[1],g=Object(a.useState)(t),p=Object(i.a)(g,2),f=p[0],x=p[1],M=Object(a.useState)(!1),v=Object(i.a)(M,2),N=v[0],T=v[1],y=Object(a.useState)(!1),I=Object(i.a)(y,2),w=I[0],D=I[1],C=Object(a.useState)(null),L=Object(i.a)(C,2),P=L[0],z=L[1],R=Object(a.useState)(0),H=Object(i.a)(R,2),U=H[0],B=H[1],F=Object(a.useState)(0),G=Object(i.a)(F,2),Z=G[0],Y=G[1];function q(e){for(var t=e.filter((function(e){return e.name.indexOf("New Project")>=0})),n=1,s="New Project";t.some((function(e){return e.name===s}));)n++,s="New Project "+n;return s}function J(e,t){t!==f[d].projects[h][e]&&(f[d].projects[h][e]=t,x(Object.values(Object(j.a)({},f))))}function Q(e){var t=f[d];return e.id=t.projects[h].id,Se.updateProject(t.id,e.id,e)}function W(){if(null!=P&&z(null),f[d].projects[h]){var e=f[d].projects[h].id;Se.getMembersFromProject(e).then((function(e){return z(e)})).catch((function(e){return console.error(e)}))}else z(null)}if(Object(a.useEffect)((function(){return W()}),[d,h,f]),JSON.stringify(f)!==JSON.stringify(t))return T(!1),void x(t);if(!f)return Object(s.jsx)("p",{children:"No projects found."});for(var _=f[d],K=!!_&&c.isDepartmentManager(_.id),$=[],X=function(e){var t=f[e];$.push(Object(s.jsx)(tt,{selected:e===d,onClick:function(){return u(e)},children:t.name},e))},ee=0;ee<f.length;ee++)X(ee);var te,ne,se=_.projects,ae=se.map((function(e,t){return Object(s.jsx)(tt,{selected:t===h,onClick:function(){return O(t)},children:e.name},t)}));if(0===se.length)te=K?Object(s.jsx)("p",{children:'There are no projects in this department. Click on "Add new project" to create a new one.'}):Object(s.jsx)("p",{children:"You aren't a member of any projects from this department."});else{if(h>=se.length)return void O(0);var re=se[h],ce=c.isProjectManager(re.id,_.id);te=Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(Ye,{name:"Project name",children:Object(s.jsx)(Ze,{value:re.name,editable:ce,fieldName:"name",postFunction:Q,onUpdated:J},"".concat(d,"-").concat(h))}),Object(s.jsx)(Ye,{name:"Description",children:Object(s.jsx)(Ze,{smaller:!0,fieldName:"description",editable:ce,value:re.description,postFunction:Q,onUpdated:J},"".concat(d,"-").concat(h))}),Object(s.jsxs)(Ye,{name:"Milestones",description:ce?"You can add a new milestone below.":" ",children:[ce?Object(s.jsx)(ot,{projectId:re.id,onMilestoneAdded:function(){B(Math.random())}},"mileform".concat(re.id)):"",Object(s.jsx)(dt,{departmentId:_.id,updateCounter:U,projectName:re.name,projectId:re.id},"list".concat(re.id))]}),ce?Object(s.jsx)(Ye,{name:"Add user to project",description:"Type their name below. They must be a department member.",children:Object(s.jsx)(lt,{onUserAdded:function(){W()},projectId:re.id,departmentId:t[d].id,submitText:"Add to ".concat(re.name)},re.name)}):"",Object(s.jsx)(Ye,{name:"Members",description:"Click on a user to see their profile and hover to show available actions.",children:Object(s.jsx)(ut,{departmentId:_.id,projectId:re.id,loading:null==P,members:P,onListUpdated:W},"".concat(d,"-").concat(h))}),Object(s.jsxs)(Ye,{name:"Tags",description:ce?"You can add a new tag below.":" ",children:[ce?Object(s.jsx)(it,{projectId:re.id,onTagAdded:function(){Y(Math.random())}},"tagform".concat(re.id)):"",Object(s.jsx)(jt,{departmentId:_.id,updateCounter:Z,projectId:re.id},"taglist".concat(re.id))]}),ce?Object(s.jsx)(Ye,{danger:!0,name:"Delete project",description:"Deletes the project, as well as its associated members, tags and tasks. <br>This action cannot be undone.",children:Object(s.jsx)(k,{className:"Button--red",onClick:function(){if(window.confirm("Are you sure to delete this project and its associated data? This action cannot be undone.")){var e=f[d];D(!0),Se.deleteProject(e.id,e.projects[h].id).then((function(){D(!1),window.scrollTo(0,0),r&&r()})).catch((function(e){D(!1),console.error(e)}))}},children:w?Object(s.jsx)(S,{red:!0}):"Delete project"})}):""]})}return ne=N?Object(s.jsx)(S,{}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(A.a,{icon:E.e,className:"AddIcon"}),"Add new project"]}),Object(s.jsxs)("div",{className:"SubsettingContainer",children:[Object(s.jsx)("div",{className:"SubsettingSidePane",children:Object(s.jsx)(at.a,{boundaryElement:".SubsettingSidePane",topOffset:-240,stickyStyle:{transform:"translateY(240px)"},children:$})}),Object(s.jsx)("div",{className:"SubsettingSidePane SubsettingSidePane--Second",children:Object(s.jsxs)(at.a,{boundaryElement:".SubsettingSidePane",topOffset:-240,stickyStyle:{transform:"translateY(240px)"},children:[K?Object(s.jsx)(tt,{reducedpadding:N,onClick:function(){if(!N){var e=f[d],t={name:q(e.projects),description:"This is a brief description."};T(!0),Se.postProject(e.id,t).then((function(){n&&n()})).catch((function(e){return console.error(e)}))}},highlighted:!0,elementDiv:N,children:ne}):void 0,ae]})}),Object(s.jsx)("div",{className:"SettingGroupsContainer",children:te})]})},mt=function(){var e=Object(a.useContext)(V);function t(){var t=e.isTeamManager?ye.getDepartments:ye.getMyDepartments,n=e.isTeamManager?Se.getProjects:Se.getMyProjects;t().then((function(e){Promise.all(e.map((function(e){return n(e.id)}))).then((function(t){for(var n=0;n<t.length;n++){var s=t[n];e[n].projects=s.sort((function(e,t){return e.name.localeCompare(t.name)}))}o(e.sort((function(e,t){return e.name.localeCompare(t.name)})))}))})).catch((function(e){return console.error(e)}))}var n=Object(a.useState)(null),r=Object(i.a)(n,2),c=r[0],o=r[1];return Object(a.useEffect)((function(){t()}),[]),c?Object(s.jsx)("div",{className:"SettingGroupsContainer",children:Object(s.jsx)(Ye,{name:"Manage projects",description:" ",children:Object(s.jsx)(bt,{departments:c,onProjectAdded:t,onProjectDeleted:t})})}):Object(s.jsx)("div",{className:"SettingGroupsContainer",children:Object(s.jsx)(Ye,{name:"Manage projects",description:" ",children:Object(s.jsx)(S,{})})})},ht=function(e){var t,n,a,r=e.department,c=e.project,o=e.values;return o?(o&&o.length>0&&(t=(o=o.sort((function(e,t){return null===e.finalDate&&null!==t.finalDate?-1:null!==e.finalDate&&null===t.finalDate?1:new Date(e.initialDate)-new Date(t.initialDate)}))).map((function(e){var t,n,a,o;return r?t=e.departmentName:c&&(t=e.projectName),r?n=e.isDepartmentManager?"Manager":"Member":c&&(n=e.isProjectManager?"Manager":"Member"),c?Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:e.departmentName}),Object(s.jsx)("td",{children:t}),Object(s.jsx)("td",{children:e.initialDate}),Object(s.jsx)("td",{children:null!==(a=e.finalDate)&&void 0!==a?a:"None"}),Object(s.jsx)("td",{children:n})]},e.id):Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{children:t}),Object(s.jsx)("td",{children:e.initialDate}),Object(s.jsx)("td",{children:null!==(o=e.finalDate)&&void 0!==o?o:"None"}),Object(s.jsx)("td",{children:n})]},e.id)}))),r?n="Department":c&&(n="Project"),a=c?Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Department"}),Object(s.jsx)("th",{children:n}),Object(s.jsx)("th",{children:"Start date"}),Object(s.jsx)("th",{children:"End date"}),Object(s.jsx)("th",{children:"Role"})]}):Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:n}),Object(s.jsx)("th",{children:"Start date"}),Object(s.jsx)("th",{children:"End date"}),Object(s.jsx)("th",{children:"Role"})]}),Object(s.jsxs)("table",{className:"UserList",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:a}),Object(s.jsx)("tbody",{children:t})]})):Object(s.jsx)(S,{})},Ot=function(e){var t=e.match.params,n=t.userId,r=(t.userName,Object(a.useContext)(V).isTeamManager),c=Object(a.useState)(null),o=Object(i.a)(c,2),l=o[0],d=o[1];function u(){W.getUserById(n).then((function(e){return d(e)})).catch((function(e){return console.error(e)}))}function j(e){return e.id=n,new Promise((function(t,n){W.updateUser(e).then((function(){u(),t()})).catch((function(e){return n(e)}))}))}if(Object(a.useEffect)((function(){u()}),[n]),null===l)return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(Be,{slim:!0,src:"/default_pfp.png",children:Object(s.jsx)(z,{darker:!0,anchored:!0})}),Object(s.jsx)("div",{className:"SettingGroupsContainer",children:Object(s.jsx)(S,{})})]});var b=l.user,m="Member";return"team_owner"===b.role?m="Team owner":l.departmentBelongs.some((function(e){return e.isDepartmentManager&&null===e.finalDate}))?m="Department manager":l.projectParticipations.some((function(e){return e.isProjectManager&&null===e.finalDate}))&&(m="Project manager"),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(at.a,{boundaryElement:".Section",topOffset:-90,stickyStyle:{transform:"translateY(90px)",zIndex:3},children:Object(s.jsx)(Be,{slim:!0,src:"/default_pfp.png",role:m,name:"".concat(b.name," ").concat(b.lastname),children:Object(s.jsx)(z,{darker:!0,anchored:!0})})}),Object(s.jsxs)("div",{className:"SettingGroupsContainer",children:[Object(s.jsx)(Ye,{name:"First name",children:Object(s.jsx)(Ze,{value:b.name,editable:r,fieldName:"name",postFunction:j})}),Object(s.jsx)(Ye,{name:"Last name",children:Object(s.jsx)(Ze,{value:b.lastname,editable:r,fieldName:"lastname",postFunction:j})}),Object(s.jsx)(Ye,{name:"Email",children:Object(s.jsx)(Ze,{value:b.email,editable:!1})}),Object(s.jsx)(Ye,{name:"User joined",children:Object(s.jsx)(Ze,{value:b.joinDate,editable:!1})}),Object(s.jsx)(Ye,{name:"Departments",description:"A list of the departments the user belongs or has belonged to.",children:Object(s.jsx)(ht,{department:!0,values:l.departmentBelongs})}),Object(s.jsx)(Ye,{name:"Projects",description:"A list of the projects the user partipates or has participated in.",children:Object(s.jsx)(ht,{project:!0,values:l.projectParticipations})}),r?Object(s.jsx)(Ye,{danger:!0,name:"Make team manager",description:"Transfer team ownership to this user. <br>This action cannot be undone and you will lose your privileges.",children:Object(s.jsx)(k,{className:"Button--red",onClick:function(){alert("TODO")},children:"Make team manager"})}):"",r?Object(s.jsx)(Ye,{danger:!0,name:"Delete user",description:"Deletes the user from the team. <br>This action cannot be undone.",children:Object(s.jsx)(k,{className:"Button--red",onClick:function(){window.confirm("Are you sure to delete this user from the team? This action cannot be undone.")&&W.deleteUser(l.user.id).then((function(){return window.location.replace("/settings/users")})).catch((function(e){return console.error(e)}))},children:"Delete user"})}):""]})]})},gt=(n(56),function(e){var t=e.tags,n=e.onSelectedIndexChanged,r=Object(a.useState)(0),c=Object(i.a)(r,2),o=c[0],l=c[1];if(Object(a.useEffect)((function(){n&&n(0===o?-1:t[o-1].id)}),[o,n,t]),t){var d=t.map((function(e,n){return Object(s.jsxs)(a.Fragment,{children:[Object(s.jsx)(me,{selected:o-1===n,color:e.color,onClick:function(){return l(n+1)},children:e.title}),n<t.length-1?Object(s.jsx)("div",{className:"TagSeparator"}):""]},e.id)}));return Object(s.jsxs)("div",{className:"TagTabContainer",children:[Object(s.jsx)(me,{selected:0===o,onClick:function(){return l(0)},children:"All tasks"}),Object(s.jsx)("div",{className:"TagSeparator"}),d]})}}),pt=function(e){var t,n=e.tags,r=e.selectedTagIds,c=e.onTagsUpdated,o=e.todo;n&&r&&(t=n.map((function(e){return{label:e.title,value:e.id,tagColor:e.color}})));var l=t.filter((function(e){return r.indexOf(e.value)>=0})),d=Object(a.useState)(r),u=Object(i.a)(d,2),j=u[0],b=u[1],m=Object(a.useState)(!1),h=Object(i.a)(m,2),O=h[0],g=h[1];return Object(s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log(j),c(o,j),g(!1)},children:[Object(s.jsx)(ge,{name:"Task tags",changeHandler:function(e,t){b(t),g(!0)},options:t,defaultOptions:l}),Object(s.jsx)(w,{reducedsize:!0,hasErrors:!O,text:"Update tags"})]})},ft=function(e){var t,n,r=e.onUserAssigned,c=e.submitText,o=e.milestoneId,l=e.projectId,d=e.todo,u=Object(a.useRef)(-1),j=Object(a.useState)(Boolean(d.assigneeId)),b=Object(i.a)(j,2),m=b[0],h=b[1];function O(){return new Promise((function(e,t){re.assignTodo(o,d.id,u.current).then((function(t){e(),console.log(u.current),h(-1!==u.current),r&&r({todo:d,id:u.current,name:t})})).catch((function(e){return t(e)}))}))}return m&&(n=Object(s.jsx)(I,{onClick:function(){u.current=-1,O()},children:"Unassign"})),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)($e,{tooManyErrorText:"This user has too many tasks assigned. Mark some as done.",disabled:null!==(t=u.current===d.assigneeId)&&void 0!==t?t:-1,hasAutocomplete:!0,submitText:c,postFunction:O,onAutocompleteSelected:function(e,t){u.current=t},children:[Object(s.jsx)("p",{className:"InputTitle",children:"Full Name"}),Object(s.jsx)(Ke,{projectId:l,name:"name",placeholder:"Harvey Specter"},u)]}),n]})},xt=function(e){var t,n=e.onCollapseClicked,a=e.onMarkAsDoneClicked,r=e.onNameUpdated,c=e.onUserAssigned,o=e.onTagsUpdated,i=e.todo,l=e.tags,d=e.projectId,u=e.milestoneId;if(i.assigneeId){var j=(i.assigneeName+" "+i.assigneeLastname).toLowerCase().replace(/ /g,"");t='Currently assigned to <a href="/settings/users/'.concat(i.assigneeId,"/").concat(j,'">').concat(i.assigneeName," ").concat(i.assigneeLastname,"</a>")}else t="Currently assigned to no one.";return Object(s.jsxs)("div",{className:"TodoDetailContainer",children:[Object(s.jsx)("span",{onClick:n,className:"BoldTitle BoldTitle--Smallest ActionButton CloseButton",children:"Collapse"}),Object(s.jsx)(I,{className:"MarkAsDoneButton",onClick:function(){return a(i)},reducedsize:!0,children:i.done?"Unmark as done":"Mark as done"}),Object(s.jsx)(Ye,{name:"Title",children:Object(s.jsx)(Ze,{value:i.title,postFunction:function(e){return r(i,e)},fieldName:"title"})}),Object(s.jsx)(Ye,{name:"Assignee",description:t,children:Object(s.jsx)(ft,{onUserAssigned:c,submitText:"Assign to task",projectId:d,milestoneId:u,todo:i})}),Object(s.jsx)(Ye,{name:"Tags",description:" ",children:Object(s.jsx)(pt,{tags:l,selectedTagIds:i.tags.map((function(e){return e.id})),todo:i,onTagsUpdated:o})})]})},Mt=function(e){var t,n=e.tags,r=e.projectId,c=e.milestoneId,o=e.selectedTagId,d=e.departmentId,u=Object(a.useContext)(V).isProjectManager(r,d),j=Object(a.useState)(-1),b=Object(i.a)(j,2),m=b[0],h=b[1],O=Object(a.useState)([]),g=Object(i.a)(O,2),p=g[0],f=g[1],x=Object(a.useState)(!0),M=Object(i.a)(x,2),v=M[0],N=M[1],T=function(){h(-1),re.getToDos(c).then((function(e){f(e),N(!1)})).catch((function(e){return console.error(e)}))},y=function(){f(JSON.parse(JSON.stringify(p))),N(!1)};function I(e){N(!0),re.markToDoAsDone(e.id,e.done).then((function(){e.done=!e.done,y()})).catch((function(e){return console.error(e)}))}function w(e,t){return t.id=e.id,new Promise((function(n,s){re.updateTitle(c,t).then((function(){e.title=t.title,y(),n()})).catch((function(e){return s(e)}))}))}function D(e){var t=e.todo;t.assigneeId=e.id,t.assigneeName=e.name,t.assigneeLastname="",y()}function C(e,t){re.setTags(c,e.id,t).then((function(t){e.tags=t.tags,y()})).catch((function(e){return console.error(e)}))}if(Object(a.useEffect)((function(){T()}),[c]),p){var L=p;-1!==o&&(L=p.filter((function(e){return e.tags.map((function(e){return e.id})).indexOf(o)>=0}))),-1===m&&(L=L.sort((function(e,t){function n(e,t){return e.localeCompare(t)}var s,a,r=(a=t,(s=e).done===a.done?0:s.done?1:-1);if(0!==r)return r;var c=function(e,t){return e.assigneeId===t.assigneeId?0:null===e.assigneeId?-1:null===t.assigneeId?1:n(e.assigneeName+e.assigneeLastname,t.assigneeName+t.assigneeLastname)}(e,t);if(0!==c)return c;var o=t.tags.length-e.tags.length;return 0!==o?o:n(e.title,t.title)}))),t=L.map((function(e,t){var o,i=e.tags.map((function(e){return Object(s.jsx)(X,{color:e.color},e.color)}));t===m&&(o=Object(s.jsx)("tr",{children:Object(s.jsx)("td",{colSpan:4,children:Object(s.jsx)(xt,{todo:e,onCollapseClicked:function(){return h(-1)},onMarkAsDoneClicked:I,onNameUpdated:w,onUserAssigned:D,onTagsUpdated:C,tags:n,projectId:r,milestoneId:c})})}));var d=(e.assigneeName+" "+e.assigneeLastname).toLowerCase().replace(/ /g,"");return Object(s.jsxs)(a.Fragment,{children:[Object(s.jsxs)("tr",{children:[Object(s.jsxs)("td",{className:e.done?"DoneTableCell":"",children:[Object(s.jsx)("i",{children:e.done?"Done: ":""}),e.title]}),Object(s.jsx)("td",{children:Object(s.jsxs)(l.b,{to:"/settings/users/".concat(e.assigneeId,"/").concat(d),children:[e.assigneeName," ",e.assigneeLastname]})}),Object(s.jsx)("td",{children:i}),Object(s.jsxs)("td",{className:"ActionStrip",children:[u?Object(s.jsx)("span",{onClick:function(){return h(t)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:"Modify"}):"",Object(s.jsxs)("span",{onClick:function(){return I(e)},className:"BoldTitle BoldTitle--Smallest ActionButton",children:[e.done?"Unm":"M","ark as done"]}),u?Object(s.jsx)("span",{onClick:function(){return t=e,void(window.confirm('Are you sure to delete task "'.concat(t.title,'"?'))&&(N(!0),re.deleteTodo(c,t.id).then((function(){var e=p.indexOf(p.find((function(e){return e.id===t.id})));p.splice(e,1),y()})).catch((function(e){return console.log(e)}))));var t},className:"BoldTitle BoldTitle--Smallest ActionButton",children:"Remove"}):""]})]}),o]},e.id)}))}return Object(s.jsxs)("table",{className:"UserList TodoTable",children:[Object(s.jsx)("thead",{className:"UserList__thead",children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Name"}),Object(s.jsx)("th",{children:"Assignee"}),Object(s.jsx)("th",{children:"Tags"}),Object(s.jsx)("th",{children:"Actions"})]})}),Object(s.jsxs)("tbody",{children:[u?Object(s.jsx)("tr",{children:Object(s.jsxs)("td",{colSpan:4,className:"AddTodoButton",onClick:function(){N(!0),re.createTodo(c,{title:"New task",done:!1}).then((function(e){-1!==o?re.setTags(c,e.id,[o]).then((function(){T()})).catch((function(e){return console.error(e)})):T()})).catch((function(e){return console.error(e)}))},children:[Object(s.jsx)(A.a,{icon:E.e,className:"AddIcon"}),"New task",v?Object(s.jsx)(S,{green:!0,className:"TodoTable__Spinner"}):""]})}):void 0,t]})]})},vt=function(e){var t=e.departmentId,n=e.milestoneId,r=e.projectId;Object(a.useEffect)((function(){be.getTags(r).then((function(e){return d(e)})).catch((function(e){return console.error(e)}))}),[r]);var c=Object(a.useState)([]),o=Object(i.a)(c,2),l=o[0],d=o[1],u=Object(a.useState)(-1),j=Object(i.a)(u,2),b=j[0],m=j[1];return Object(s.jsxs)("div",{className:"TodoTableContainer",children:[Object(s.jsx)(gt,{tags:l,onSelectedIndexChanged:function(e){return m(e)}}),Object(s.jsx)(Mt,{tags:l,projectId:r,departmentId:t,milestoneId:n,selectedTagId:b})]})},Nt=function(e){var t,n,r=e.match.params,c=r.projectName,o=r.departmentId,l=r.projectId,d=r.milestoneName,u=r.milestoneId,j=Object(a.useContext)(V).isProjectManager(l,o),b=Object(a.useState)(null),m=Object(i.a)(b,2),h=m[0],O=m[1],g=c.replace(/-/g," "),p=d.replace(/-/g," ");function f(){Le.getMilestoneById(l,u).then((function(e){return O(e)})).catch((function(e){return console.error(e)}))}function x(e){var t,n;return e.id=u,e.name=null!==(t=e.name)&&void 0!==t?t:h.name,e.dueFor=null!==(n=e.dueFor)&&void 0!==n?n:h.dueFor,new Promise((function(t,n){Le.createMilestone(l,e).then((function(){f(),t()})).catch((function(e){return n()}))}))}return Object(a.useEffect)((function(){f()}),[l,u]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(at.a,{boundaryElement:".Section",topOffset:-90,stickyStyle:{transform:"translateY(90px)",zIndex:3},children:Object(s.jsxs)("div",{className:"ProfileHeader ProfileHeader--Slim",children:[Object(s.jsx)(z,{darker:!0,anchored:!0}),Object(s.jsxs)("div",{className:"ProfileTitleContainer",children:[Object(s.jsx)("h3",{className:"TinyTitle",children:g}),Object(s.jsx)("h1",{className:"BigTitle BigTitle--Slim",children:null!==(t=null===h||void 0===h?void 0:h.name)&&void 0!==t?t:p})]})]})}),Object(s.jsxs)("div",{className:"SettingGroupsContainer",children:[Object(s.jsx)(Ye,{name:"Name",children:Object(s.jsx)(Ze,{editable:j,value:null!==(n=null===h||void 0===h?void 0:h.name)&&void 0!==n?n:p,postFunction:x,fieldName:"name"})}),Object(s.jsx)(Ye,{name:"Due by",children:Object(s.jsx)(Ze,{editable:j,inputType:"date",value:null===h||void 0===h?void 0:h.dueFor,postFunction:x,fieldName:"dueFor"})}),Object(s.jsx)(Ye,{name:"Tasks",description:" ",children:Object(s.jsx)(vt,{departmentId:o,projectId:l,milestoneId:u})}),j?Object(s.jsx)(Ye,{name:"Delete milestone",description:"Deletes the milestone and associated tasks from the team.",children:Object(s.jsx)(k,{className:"Button--red",onClick:function(){window.confirm("Are you sure to delete this milestone and associated tasks?")&&Le.deleteMilestone(u).then((function(){return window.location.replace("/settings/projects")})).catch((function(e){return console.error(e)}))},children:"Delete milestone"})}):""]})]})},Tt=["/settings/team","/settings/departments","/settings/projects","/settings/users"],yt=function(){var e=Object(a.useContext)(V),t=Object(d.g)();return void 0===e.isTeamManager?Object(s.jsxs)("div",{className:"Content",children:[Object(s.jsx)(Ue,{}),Object(s.jsx)(ze,{className:"Section--Lighter",children:Object(s.jsx)("div",{className:"SettingGroupsContainer",children:Object(s.jsx)(S,{})})})]}):void 0!==e.isTeamManager&&t.pathname.indexOf("/settings")>=0&&-1===Tt.indexOf(t.pathname)&&!(t.pathname.indexOf("/settings/projects")>=0||t.pathname.indexOf("/settings/users")>=0)?e.isTeamManager?Object(s.jsx)(d.a,{to:"/settings/team"}):Object(s.jsx)(d.a,{to:"/settings/projects"}):Object(s.jsxs)("div",{className:"Content",children:[Object(s.jsx)(Ue,{}),Object(s.jsxs)(ze,{className:"Section--Lighter",children:[Object(s.jsx)(Be,{src:"/default_pfp.png",role:e.getRoleName(),name:e.user.name+" "+e.user.lastname}),Object(s.jsxs)(d.d,{children:[Object(s.jsx)(d.b,{path:"/settings/team",children:Object(s.jsx)(qe,{})}),Object(s.jsx)(d.b,{path:"/settings/departments",children:Object(s.jsx)(ct,{})}),Object(s.jsx)(d.b,{path:"/settings/users/:userId/:userName",component:Ot}),Object(s.jsx)(d.b,{path:"/settings/projects/:departmentId/:projectName/:projectId/:milestoneName/:milestoneId",component:Nt}),Object(s.jsx)(d.b,{path:"/settings/projects",children:Object(s.jsx)(mt,{})}),Object(s.jsx)(d.b,{path:"/settings/users",children:Object(s.jsx)(We,{})})]})]})]})},It=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(s.jsxs)(l.a,{children:[Object(s.jsx)(J,{}),Object(s.jsxs)(d.d,{children:[Object(s.jsxs)(d.b,{exact:!0,path:"/",children:[Object(s.jsx)(q,{handleSearch:r}),Object(s.jsx)(Re,{search:n,setSearch:r})]}),Object(s.jsxs)(d.b,{path:"/settings",children:[Object(s.jsx)(q,{nosearchbar:!0}),Object(s.jsx)(_,{children:Object(s.jsx)(yt,{})})]})]})]})};var St=function(){var e,t=Object(a.useState)(!1),n=Object(i.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(!1),l=Object(i.a)(o,2),d=l[0],u=l[1];return Object(a.useEffect)((function(){r||d||v.islogged().then((function(){c(!0),u(!0)})).catch((function(){c(!1),u(!0)}))})),d&&(e=r?Object(s.jsx)(It,{onLoginChanged:c}):Object(s.jsx)(H,{onLoginChanged:c})),Object(s.jsx)("div",{className:"App",children:e})},wt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,125)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),r(e),c(e)}))};o.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(St,{})}),document.getElementById("root")),wt()},19:function(e,t,n){},22:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},32:function(e,t,n){},34:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},56:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){},89:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){}},[[123,1,2]]]);
//# sourceMappingURL=main.2991b262.chunk.js.map